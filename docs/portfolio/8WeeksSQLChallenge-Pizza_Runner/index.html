<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chirag Sharma">
<meta name="dcterms.date" content="2024-01-02">
<meta name="description" content="In this post, we’ll tackle the second case study using MySQL from 8weeksqlchallenge.com. We’ll Explore the Pizza Runner case study with us, delving into the data to optimize operations and unveil customer insights using SQL analytics. Join the journey where ’80s Retro Styling and Pizza is the future drive the success of this innovative pizza delivery venture!">

<title>Case Study #2 - Pizza Runner.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon/icons8-darth-vader-512.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Chirag Sharma’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html" rel="" target="">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume/chirag_sharma_resume.pdf" rel="" target="">
 <span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Chirag1994" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/chiragsharma1994/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:chirag.sharma0378@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Case Study #2 - Pizza Runner.</h1>
                  <div>
        <div class="description">
          In this post, we’ll tackle the second case study using MySQL from 8weeksqlchallenge.com. We’ll Explore the Pizza Runner case study with us, delving into the data to optimize operations and unveil customer insights using SQL analytics. Join the journey where ’80s Retro Styling and Pizza is the future drive the success of this innovative pizza delivery venture!
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">MySQL</div>
                <div class="quarto-category">SQL</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://chirag1994.github.io/">Chirag Sharma</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 2, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#case-study-2---pizza-runner" id="toc-case-study-2---pizza-runner" class="nav-link active" data-scroll-target="#case-study-2---pizza-runner">Case Study #2 - Pizza Runner</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#available-data" id="toc-available-data" class="nav-link" data-scroll-target="#available-data">Available Data</a></li>
  <li><a href="#entity-relationship-diagram" id="toc-entity-relationship-diagram" class="nav-link" data-scroll-target="#entity-relationship-diagram">Entity Relationship Diagram</a>
  <ul class="collapse">
  <li><a href="#table-1-runners" id="toc-table-1-runners" class="nav-link" data-scroll-target="#table-1-runners">Table 1: runners</a></li>
  <li><a href="#table-2-customer_orders" id="toc-table-2-customer_orders" class="nav-link" data-scroll-target="#table-2-customer_orders">Table 2: customer_orders</a></li>
  <li><a href="#table-3-runner_orders" id="toc-table-3-runner_orders" class="nav-link" data-scroll-target="#table-3-runner_orders">Table 3: runner_orders</a></li>
  <li><a href="#table-4-pizza_names" id="toc-table-4-pizza_names" class="nav-link" data-scroll-target="#table-4-pizza_names">Table 4: pizza_names</a></li>
  <li><a href="#table-5-pizza_recipes" id="toc-table-5-pizza_recipes" class="nav-link" data-scroll-target="#table-5-pizza_recipes">Table 5: pizza_recipes</a></li>
  <li><a href="#table-6-pizza_toppings" id="toc-table-6-pizza_toppings" class="nav-link" data-scroll-target="#table-6-pizza_toppings">Table 6: pizza_toppings</a></li>
  </ul></li>
  <li><a href="#interactive-sql-session" id="toc-interactive-sql-session" class="nav-link" data-scroll-target="#interactive-sql-session">Interactive SQL Session</a></li>
  <li><a href="#case-study-questions" id="toc-case-study-questions" class="nav-link" data-scroll-target="#case-study-questions">Case Study Questions</a>
  <ul class="collapse">
  <li><a href="#a.-pizza-metrics" id="toc-a.-pizza-metrics" class="nav-link" data-scroll-target="#a.-pizza-metrics">A. Pizza Metrics</a></li>
  <li><a href="#b.-runner-and-customer-experience" id="toc-b.-runner-and-customer-experience" class="nav-link" data-scroll-target="#b.-runner-and-customer-experience">B. Runner and Customer Experience</a></li>
  <li><a href="#c.-ingredient-optimisation" id="toc-c.-ingredient-optimisation" class="nav-link" data-scroll-target="#c.-ingredient-optimisation">C. Ingredient Optimisation</a></li>
  <li><a href="#d.-pricing-and-ratings" id="toc-d.-pricing-and-ratings" class="nav-link" data-scroll-target="#d.-pricing-and-ratings">D. Pricing and Ratings</a></li>
  <li><a href="#e.-bonus-questions" id="toc-e.-bonus-questions" class="nav-link" data-scroll-target="#e.-bonus-questions">E. Bonus Questions</a></li>
  </ul></li>
  <li><a href="#lets-start-solving-them." id="toc-lets-start-solving-them." class="nav-link" data-scroll-target="#lets-start-solving-them.">Let’s start solving them.</a>
  <ul class="collapse">
  <li><a href="#performing-the-data-cleaning-transformations-first" id="toc-performing-the-data-cleaning-transformations-first" class="nav-link" data-scroll-target="#performing-the-data-cleaning-transformations-first">Performing the Data Cleaning/ Transformations first!</a></li>
  <li><a href="#cleaning-customer_orders-table" id="toc-cleaning-customer_orders-table" class="nav-link" data-scroll-target="#cleaning-customer_orders-table">Cleaning Customer_Orders Table</a></li>
  <li><a href="#cleaning-runner_orders-table" id="toc-cleaning-runner_orders-table" class="nav-link" data-scroll-target="#cleaning-runner_orders-table">Cleaning Runner_Orders Table</a></li>
  </ul></li>
  <li><a href="#a.-pizza-metrics-1" id="toc-a.-pizza-metrics-1" class="nav-link" data-scroll-target="#a.-pizza-metrics-1">A. Pizza Metrics</a>
  <ul class="collapse">
  <li><a href="#how-many-pizzas-were-ordered" id="toc-how-many-pizzas-were-ordered" class="nav-link" data-scroll-target="#how-many-pizzas-were-ordered">1. How many pizzas were ordered?</a></li>
  <li><a href="#how-many-unique-customer-orders-were-made" id="toc-how-many-unique-customer-orders-were-made" class="nav-link" data-scroll-target="#how-many-unique-customer-orders-were-made">2. How many unique customer orders were made?</a></li>
  <li><a href="#how-many-successful-orders-were-delivered-by-each-runner" id="toc-how-many-successful-orders-were-delivered-by-each-runner" class="nav-link" data-scroll-target="#how-many-successful-orders-were-delivered-by-each-runner">3. How many successful orders were delivered by each runner?</a></li>
  <li><a href="#how-many-of-each-type-of-pizza-was-delivered" id="toc-how-many-of-each-type-of-pizza-was-delivered" class="nav-link" data-scroll-target="#how-many-of-each-type-of-pizza-was-delivered">4. How many of each type of pizza was delivered?</a></li>
  <li><a href="#how-many-vegetarian-and-meatlovers-were-ordered-by-each-customer" id="toc-how-many-vegetarian-and-meatlovers-were-ordered-by-each-customer" class="nav-link" data-scroll-target="#how-many-vegetarian-and-meatlovers-were-ordered-by-each-customer">5. How many Vegetarian and Meatlovers were ordered by each customer?</a></li>
  <li><a href="#what-was-the-maximum-number-of-pizzas-delivered-in-a-single-order" id="toc-what-was-the-maximum-number-of-pizzas-delivered-in-a-single-order" class="nav-link" data-scroll-target="#what-was-the-maximum-number-of-pizzas-delivered-in-a-single-order">6. What was the maximum number of pizzas delivered in a single order?</a></li>
  <li><a href="#for-each-customer-how-many-delivered-pizzas-had-at-least-1-change-and-how-many-had-no-changes" id="toc-for-each-customer-how-many-delivered-pizzas-had-at-least-1-change-and-how-many-had-no-changes" class="nav-link" data-scroll-target="#for-each-customer-how-many-delivered-pizzas-had-at-least-1-change-and-how-many-had-no-changes">7. For each customer, how many delivered pizzas had at least 1 change and how many had no changes?</a></li>
  <li><a href="#how-many-pizzas-were-delivered-that-had-both-exclusions-and-extras" id="toc-how-many-pizzas-were-delivered-that-had-both-exclusions-and-extras" class="nav-link" data-scroll-target="#how-many-pizzas-were-delivered-that-had-both-exclusions-and-extras">8. How many pizzas were delivered that had both exclusions and extras?</a></li>
  <li><a href="#what-was-the-total-volume-of-pizzas-ordered-for-each-hour-of-the-day" id="toc-what-was-the-total-volume-of-pizzas-ordered-for-each-hour-of-the-day" class="nav-link" data-scroll-target="#what-was-the-total-volume-of-pizzas-ordered-for-each-hour-of-the-day">9. What was the total volume of pizzas ordered for each hour of the day?</a></li>
  <li><a href="#what-was-the-volume-of-orders-for-each-day-of-the-week" id="toc-what-was-the-volume-of-orders-for-each-day-of-the-week" class="nav-link" data-scroll-target="#what-was-the-volume-of-orders-for-each-day-of-the-week">10. What was the volume of orders for each day of the week?</a></li>
  </ul></li>
  <li><a href="#b.-runner-and-customer-experience-1" id="toc-b.-runner-and-customer-experience-1" class="nav-link" data-scroll-target="#b.-runner-and-customer-experience-1">B. Runner and Customer Experience</a>
  <ul class="collapse">
  <li><a href="#how-many-runners-signed-up-for-each-1-week-period-i.e.-week-starts-2021-01-01" id="toc-how-many-runners-signed-up-for-each-1-week-period-i.e.-week-starts-2021-01-01" class="nav-link" data-scroll-target="#how-many-runners-signed-up-for-each-1-week-period-i.e.-week-starts-2021-01-01">1. How many runners signed up for each 1 week period? (i.e.&nbsp;week starts 2021-01-01)</a></li>
  <li><a href="#what-was-the-average-time-in-minutes-it-took-for-each-runner-to-arrive-at-the-pizza-runner-hq-to-pickup-the-order" id="toc-what-was-the-average-time-in-minutes-it-took-for-each-runner-to-arrive-at-the-pizza-runner-hq-to-pickup-the-order" class="nav-link" data-scroll-target="#what-was-the-average-time-in-minutes-it-took-for-each-runner-to-arrive-at-the-pizza-runner-hq-to-pickup-the-order">2. What was the average time in minutes it took for each runner to arrive at the Pizza Runner HQ to pickup the order?</a></li>
  <li><a href="#is-there-any-relationship-between-the-number-of-pizzas-and-how-long-the-order-takes-to-prepare" id="toc-is-there-any-relationship-between-the-number-of-pizzas-and-how-long-the-order-takes-to-prepare" class="nav-link" data-scroll-target="#is-there-any-relationship-between-the-number-of-pizzas-and-how-long-the-order-takes-to-prepare">3. Is there any relationship between the number of pizzas and how long the order takes to prepare?</a></li>
  <li><a href="#what-was-the-average-distance-travelled-for-each-customer" id="toc-what-was-the-average-distance-travelled-for-each-customer" class="nav-link" data-scroll-target="#what-was-the-average-distance-travelled-for-each-customer">4. What was the average distance travelled for each customer?</a></li>
  <li><a href="#what-was-the-difference-between-the-longest-and-shortest-delivery-times-for-all-orders" id="toc-what-was-the-difference-between-the-longest-and-shortest-delivery-times-for-all-orders" class="nav-link" data-scroll-target="#what-was-the-difference-between-the-longest-and-shortest-delivery-times-for-all-orders">5. What was the difference between the longest and shortest delivery times for all orders?</a></li>
  <li><a href="#what-was-the-average-speed-for-each-runner-for-each-delivery-and-do-you-notice-any-trend-for-these-values" id="toc-what-was-the-average-speed-for-each-runner-for-each-delivery-and-do-you-notice-any-trend-for-these-values" class="nav-link" data-scroll-target="#what-was-the-average-speed-for-each-runner-for-each-delivery-and-do-you-notice-any-trend-for-these-values">6. What was the average speed for each runner for each delivery and do you notice any trend for these values?</a></li>
  <li><a href="#what-is-the-successful-delivery-percentage-for-each-runner" id="toc-what-is-the-successful-delivery-percentage-for-each-runner" class="nav-link" data-scroll-target="#what-is-the-successful-delivery-percentage-for-each-runner">7. What is the successful delivery percentage for each runner?</a></li>
  </ul></li>
  <li><a href="#c.-ingredient-optimisation-1" id="toc-c.-ingredient-optimisation-1" class="nav-link" data-scroll-target="#c.-ingredient-optimisation-1">C. Ingredient Optimisation</a></li>
  <li><a href="#data-cleaning-pizza_recipes-table" id="toc-data-cleaning-pizza_recipes-table" class="nav-link" data-scroll-target="#data-cleaning-pizza_recipes-table">DATA CLEANING pizza_recipes table</a>
  <ul class="collapse">
  <li><a href="#what-are-the-standard-ingredients-for-each-pizza" id="toc-what-are-the-standard-ingredients-for-each-pizza" class="nav-link" data-scroll-target="#what-are-the-standard-ingredients-for-each-pizza">1. What are the standard ingredients for each pizza?</a></li>
  <li><a href="#what-was-the-most-commonly-added-extra" id="toc-what-was-the-most-commonly-added-extra" class="nav-link" data-scroll-target="#what-was-the-most-commonly-added-extra">2. What was the most commonly added extra?</a></li>
  <li><a href="#what-was-the-most-common-exclusion" id="toc-what-was-the-most-common-exclusion" class="nav-link" data-scroll-target="#what-was-the-most-common-exclusion">3. What was the most common exclusion?</a></li>
  <li><a href="#generate-an-order-item-for-each-record-in-the-customers_orders-table-in-the-format-of-one-of-the-following" id="toc-generate-an-order-item-for-each-record-in-the-customers_orders-table-in-the-format-of-one-of-the-following" class="nav-link" data-scroll-target="#generate-an-order-item-for-each-record-in-the-customers_orders-table-in-the-format-of-one-of-the-following">4. Generate an order item for each record in the customers_orders table in the format of one of the following:</a></li>
  <li><a href="#generate-an-alphabetically-ordered-comma-separated-ingredient-list-for-each-pizza-order-from-the-customer_orders-table-and-add-a-2x-in-front-of-any-relevant-ingredients." id="toc-generate-an-alphabetically-ordered-comma-separated-ingredient-list-for-each-pizza-order-from-the-customer_orders-table-and-add-a-2x-in-front-of-any-relevant-ingredients." class="nav-link" data-scroll-target="#generate-an-alphabetically-ordered-comma-separated-ingredient-list-for-each-pizza-order-from-the-customer_orders-table-and-add-a-2x-in-front-of-any-relevant-ingredients.">5. Generate an alphabetically ordered comma separated ingredient list for each pizza order from the customer_orders table and add a 2x in front of any relevant ingredients.</a></li>
  <li><a href="#what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first" id="toc-what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first" class="nav-link" data-scroll-target="#what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first">6. What is the total quantity of each ingredient used in all delivered pizzas sorted by most frequent first?</a></li>
  </ul></li>
  <li><a href="#d.-pricing-and-ratings-1" id="toc-d.-pricing-and-ratings-1" class="nav-link" data-scroll-target="#d.-pricing-and-ratings-1">D. Pricing and Ratings</a>
  <ul class="collapse">
  <li><a href="#if-a-meat-lovers-pizza-costs-12-and-vegetarian-costs-10-and-there-were-no-charges-for-changes---how-much-money-has-pizza-runner-made-so-far-if-there-are-no-delivery-fees" id="toc-if-a-meat-lovers-pizza-costs-12-and-vegetarian-costs-10-and-there-were-no-charges-for-changes---how-much-money-has-pizza-runner-made-so-far-if-there-are-no-delivery-fees" class="nav-link" data-scroll-target="#if-a-meat-lovers-pizza-costs-12-and-vegetarian-costs-10-and-there-were-no-charges-for-changes---how-much-money-has-pizza-runner-made-so-far-if-there-are-no-delivery-fees">1. If a Meat Lovers pizza costs $12 and Vegetarian costs $10 and there were no charges for changes - how much money has Pizza Runner made so far if there are no delivery fees?</a></li>
  <li><a href="#what-if-there-was-an-additional-1-charge-for-any-pizza-extras-add-cheese-is-1-extra" id="toc-what-if-there-was-an-additional-1-charge-for-any-pizza-extras-add-cheese-is-1-extra" class="nav-link" data-scroll-target="#what-if-there-was-an-additional-1-charge-for-any-pizza-extras-add-cheese-is-1-extra">2. What if there was an additional $1 charge for any pizza extras? (Add cheese is $1 extra)</a></li>
  <li><a href="#the-pizza-runner-team-now-wants-to-add-an-additional-ratings-system-that-allows-customers-to-rate-their-runner-how-would-you-design-an-additional-table-for-this-new-dataset---generate-a-schema-for-this-new-table-and-insert-your-own-data-for-ratings-for-each-successful-customer-order-between-1-to-5." id="toc-the-pizza-runner-team-now-wants-to-add-an-additional-ratings-system-that-allows-customers-to-rate-their-runner-how-would-you-design-an-additional-table-for-this-new-dataset---generate-a-schema-for-this-new-table-and-insert-your-own-data-for-ratings-for-each-successful-customer-order-between-1-to-5." class="nav-link" data-scroll-target="#the-pizza-runner-team-now-wants-to-add-an-additional-ratings-system-that-allows-customers-to-rate-their-runner-how-would-you-design-an-additional-table-for-this-new-dataset---generate-a-schema-for-this-new-table-and-insert-your-own-data-for-ratings-for-each-successful-customer-order-between-1-to-5.">3. The Pizza Runner team now wants to add an additional ratings system that allows customers to rate their runner, how would you design an additional table for this new dataset - generate a schema for this new table and insert your own data for ratings for each successful customer order between 1 to 5.</a></li>
  <li><a href="#using-your-newly-generated-table---can-you-join-all-of-the-information-together-to-form-a-table-which-has-the-following-information-for-successful-deliveries" id="toc-using-your-newly-generated-table---can-you-join-all-of-the-information-together-to-form-a-table-which-has-the-following-information-for-successful-deliveries" class="nav-link" data-scroll-target="#using-your-newly-generated-table---can-you-join-all-of-the-information-together-to-form-a-table-which-has-the-following-information-for-successful-deliveries">4. Using your newly generated table - can you join all of the information together to form a table which has the following information for successful deliveries?</a></li>
  <li><a href="#if-a-meat-lovers-pizza-was-12-and-vegetarian-10-fixed-prices-with-no-cost-for-extras-and-each-runner-is-paid-0.30-per-kilometre-traveled---how-much-money-does-pizza-runner-have-left-over-after-these-deliveries" id="toc-if-a-meat-lovers-pizza-was-12-and-vegetarian-10-fixed-prices-with-no-cost-for-extras-and-each-runner-is-paid-0.30-per-kilometre-traveled---how-much-money-does-pizza-runner-have-left-over-after-these-deliveries" class="nav-link" data-scroll-target="#if-a-meat-lovers-pizza-was-12-and-vegetarian-10-fixed-prices-with-no-cost-for-extras-and-each-runner-is-paid-0.30-per-kilometre-traveled---how-much-money-does-pizza-runner-have-left-over-after-these-deliveries">5. If a Meat Lovers pizza was $12 and Vegetarian $10 fixed prices with no cost for extras and each runner is paid $0.30 per kilometre traveled - how much money does Pizza Runner have left over after these deliveries?</a></li>
  <li><a href="#what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first-1" id="toc-what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first-1" class="nav-link" data-scroll-target="#what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first-1">6. What is the total quantity of each ingredient used in all delivered pizzas sorted by most frequent first?</a></li>
  </ul></li>
  <li><a href="#e.-bonus-questions-1" id="toc-e.-bonus-questions-1" class="nav-link" data-scroll-target="#e.-bonus-questions-1">E. Bonus Questions</a>
  <ul class="collapse">
  <li><a href="#if-danny-wants-to-expand-his-range-of-pizzas---how-would-this-impact-the-existing-data-design-write-an-insert-statement-to-demonstrate-what-would-happen-if-a-new-supreme-pizza-with-all-the-toppings-was-added-to-the-pizza-runner-menu" id="toc-if-danny-wants-to-expand-his-range-of-pizzas---how-would-this-impact-the-existing-data-design-write-an-insert-statement-to-demonstrate-what-would-happen-if-a-new-supreme-pizza-with-all-the-toppings-was-added-to-the-pizza-runner-menu" class="nav-link" data-scroll-target="#if-danny-wants-to-expand-his-range-of-pizzas---how-would-this-impact-the-existing-data-design-write-an-insert-statement-to-demonstrate-what-would-happen-if-a-new-supreme-pizza-with-all-the-toppings-was-added-to-the-pizza-runner-menu">1. If Danny wants to expand his range of pizzas - how would this impact the existing data design? Write an INSERT statement to demonstrate what would happen if a new Supreme pizza with all the toppings was added to the Pizza Runner menu?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<section id="case-study-2---pizza-runner" class="level1">
<h1>Case Study #2 - Pizza Runner</h1>
<p><img src="./Images/Case_Study_2-Pizza_Runner.png" alt="Image1" width="800" height="800"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Did you know that over <strong>115 million kilograms</strong> of pizza is consumed daily worldwide??? (Well according to Wikipedia anyway…)</p>
<p>Danny was scrolling through his Instagram feed when something really caught his eye - “80s Retro Styling and Pizza Is The Future!”</p>
<p>Danny was sold on the idea, but he knew that pizza alone was not going to help him get seed funding to expand his new Pizza Empire - so he had one more genius idea to combine with it - he was going to <strong><em>Uberize</em></strong> it - and so Pizza Runner was launched!</p>
<p>Danny started by recruiting “runners” to deliver fresh pizza from Pizza Runner Headquarters (otherwise known as Danny’s house) and also maxed out his credit card to pay freelance developers to build a mobile app to accept orders from customers.</p>
</section>
<section id="available-data" class="level2">
<h2 class="anchored" data-anchor-id="available-data">Available Data</h2>
<p>Because Danny had a few years of experience as a data scientist - he was very aware that data collection was going to be critical for his business’ growth.</p>
<p>He has prepared for us an entity relationship diagram of his database design but requires further assistance to clean his data and apply some basic calculations so he can better direct his runners and optimise Pizza Runner’s operations.</p>
<p>All datasets exist within the <code>pizza_runner</code> database schema - be sure to include this reference within your SQL scripts as you start exploring the data and answering the case study questions.</p>
</section>
<section id="entity-relationship-diagram" class="level2">
<h2 class="anchored" data-anchor-id="entity-relationship-diagram">Entity Relationship Diagram</h2>
<p><img src="./Images/Case_Study_2-ER_Diagram.png" alt="Image1" width="800" height="800"></p>
<section id="table-1-runners" class="level3">
<h3 class="anchored" data-anchor-id="table-1-runners">Table 1: runners</h3>
<p>The <code>runners</code> table shows the <code>registration_date</code> for each new runner</p>
<table class="table">
<thead>
<tr class="header">
<th>runner_id</th>
<th>registration_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2021-01-01</td>
</tr>
<tr class="even">
<td>2</td>
<td>2021-01-03</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2021-01-08</td>
</tr>
<tr class="even">
<td>4</td>
<td>2021-01-15</td>
</tr>
</tbody>
</table>
</section>
<section id="table-2-customer_orders" class="level3">
<h3 class="anchored" data-anchor-id="table-2-customer_orders">Table 2: customer_orders</h3>
<p>Customer pizza orders are captured in the <code>customer_orders</code> table with 1 row for each individual pizza that is part of the order.</p>
<p>The <code>pizza_id</code> relates to the type of pizza which was ordered whilst the <code>exclusions</code> are the <code>ingredient_id</code> values which should be removed from the pizza and the <code>extras</code> are the <code>ingredient_id</code> values which need to be added to the pizza.</p>
<p>Note that customers can order multiple pizzas in a single order with varying <code>exclusions</code> and <code>extras</code> values even if the pizza is the same type!</p>
<p>The <code>exclusions</code> and <code>extras</code> columns will need to be cleaned up before using them in your queries.</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>order_id</th>
<th>customer_id</th>
<th>pizza_id</th>
<th>exclusions</th>
<th>extras</th>
<th>order_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>101</td>
<td>1</td>
<td></td>
<td></td>
<td>2021-01-01 18:05:02</td>
</tr>
<tr class="even">
<td>2</td>
<td>101</td>
<td>1</td>
<td></td>
<td></td>
<td>2021-01-01 19:00:52</td>
</tr>
<tr class="odd">
<td>3</td>
<td>102</td>
<td>1</td>
<td></td>
<td></td>
<td>2021-01-02 23:51:23</td>
</tr>
<tr class="even">
<td>3</td>
<td>102</td>
<td>2</td>
<td>NaN</td>
<td></td>
<td>2021-01-02 23:51:23</td>
</tr>
<tr class="odd">
<td>4</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td></td>
<td>2021-01-04 13:23:46</td>
</tr>
<tr class="even">
<td>4</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td></td>
<td>2021-01-04 13:23:46</td>
</tr>
<tr class="odd">
<td>4</td>
<td>103</td>
<td>2</td>
<td>4</td>
<td></td>
<td>2021-01-04 13:23:46</td>
</tr>
<tr class="even">
<td>5</td>
<td>104</td>
<td>1</td>
<td>null</td>
<td>1</td>
<td>2021-01-08 21:00:29</td>
</tr>
<tr class="odd">
<td>6</td>
<td>101</td>
<td>2</td>
<td>null</td>
<td>null</td>
<td>2021-01-08 21:03:13</td>
</tr>
<tr class="even">
<td>7</td>
<td>105</td>
<td>2</td>
<td>null</td>
<td>1</td>
<td>2021-01-08 21:20:29</td>
</tr>
<tr class="odd">
<td>8</td>
<td>102</td>
<td>1</td>
<td>null</td>
<td>null</td>
<td>2021-01-09 23:54:33</td>
</tr>
<tr class="even">
<td>9</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td>1, 5</td>
<td>2021-01-10 11:22:59</td>
</tr>
<tr class="odd">
<td>10</td>
<td>104</td>
<td>1</td>
<td>null</td>
<td>null</td>
<td>2021-01-11 18:34:49</td>
</tr>
<tr class="even">
<td>10</td>
<td>104</td>
<td>1</td>
<td>2, 6</td>
<td>1, 4</td>
<td>2021-01-11 18:34:49</td>
</tr>
</tbody>
</table>
</section>
<section id="table-3-runner_orders" class="level3">
<h3 class="anchored" data-anchor-id="table-3-runner_orders">Table 3: runner_orders</h3>
<p>After each orders are received through the system - they are assigned to a runner - however not all orders are fully completed and can be cancelled by the restaurant or the customer.</p>
<p>The <code>pickup_time</code> is the timestamp at which the runner arrives at the Pizza Runner headquarters to pick up the freshly cooked pizzas. The <code>distance</code> and <code>duration</code> fields are related to how far and long the runner had to travel to deliver the order to the respective customer.</p>
<p>There are some known data issues with this table so be careful when using this in your queries - make sure to check the data types for each column in the schema SQL!</p>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>order_id</th>
<th>runner_id</th>
<th>pickup_time</th>
<th>distance</th>
<th>duration</th>
<th>cancellation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2021-01-01 18:15:34</td>
<td>20km</td>
<td>32 minutes</td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>2021-01-01 19:10:54</td>
<td>20km</td>
<td>27 minutes</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>2021-01-03 00:12:37</td>
<td>13.4km</td>
<td>20 mins</td>
<td>NaN</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>2021-01-04 13:53:03</td>
<td>23.4</td>
<td>40</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>2021-01-08 21:10:57</td>
<td>10</td>
<td>15</td>
<td>NaN</td>
</tr>
<tr class="even">
<td>6</td>
<td>3</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>Restaurant Cancellation</td>
</tr>
<tr class="odd">
<td>7</td>
<td>2</td>
<td>2020-01-08 21:30:45</td>
<td>25km</td>
<td>25mins</td>
<td>null</td>
</tr>
<tr class="even">
<td>8</td>
<td>2</td>
<td>2020-01-10 00:15:02</td>
<td>23.4 km</td>
<td>15 minute</td>
<td>null</td>
</tr>
<tr class="odd">
<td>9</td>
<td>2</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>Customer Cancellation</td>
</tr>
<tr class="even">
<td>10</td>
<td>1</td>
<td>2020-01-11 18:50:20</td>
<td>10km</td>
<td>10 minutes</td>
<td>null</td>
</tr>
</tbody>
</table>
</section>
<section id="table-4-pizza_names" class="level3">
<h3 class="anchored" data-anchor-id="table-4-pizza_names">Table 4: pizza_names</h3>
<p>At the moment - Pizza Runner only has 2 pizzas available the Meat Lovers or Vegetarian!</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_id</th>
<th>pizza_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Meat Lovers</td>
</tr>
<tr class="even">
<td>2</td>
<td>Vegetarian</td>
</tr>
</tbody>
</table>
</section>
<section id="table-5-pizza_recipes" class="level3">
<h3 class="anchored" data-anchor-id="table-5-pizza_recipes">Table 5: pizza_recipes</h3>
<p>Each <code>pizza_id</code> has a standard set of <code>toppings</code> which are used as part of the pizza recipe.</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_id</th>
<th>toppings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1, 2, 3, 4, 5, 6, 8, 10</td>
</tr>
<tr class="even">
<td>2</td>
<td>4, 6, 7, 9, 11, 12</td>
</tr>
</tbody>
</table>
</section>
<section id="table-6-pizza_toppings" class="level3">
<h3 class="anchored" data-anchor-id="table-6-pizza_toppings">Table 6: pizza_toppings</h3>
<p>This table contains all of the topping_name values with their corresponding topping_id value</p>
<table class="table">
<thead>
<tr class="header">
<th>topping_id</th>
<th>topping_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Bacon</td>
</tr>
<tr class="even">
<td>2</td>
<td>BBQ Sauce</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Beef</td>
</tr>
<tr class="even">
<td>4</td>
<td>Cheese</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Chicken</td>
</tr>
<tr class="even">
<td>6</td>
<td>Mushrooms</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Onions</td>
</tr>
<tr class="even">
<td>8</td>
<td>Pepperoni</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Peppers</td>
</tr>
<tr class="even">
<td>10</td>
<td>Salami</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Tomatoes</td>
</tr>
<tr class="even">
<td>12</td>
<td>Tomato Sauce</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="interactive-sql-session" class="level2">
<h2 class="anchored" data-anchor-id="interactive-sql-session">Interactive SQL Session</h2>
<p>The Dataset for this case study can be accessed from <a href="https://www.db-fiddle.com/f/7VcQKQwsS3CTkGRFG7vu98/65">here</a>. I will be using MySQL to solve this case study. In order to solve yourself this case study, simply go to the above link and choose MySQL Dialect (version &gt; 8, if using MySQL version higher than 8 locally), copy &amp; paste the Database schema into MySQL.</p>
<p>Here is the snapshot of it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">SCHEMA</span> pizza_runner;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">USE</span> pizza_runner;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> runners;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> runners (</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  `runner_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  `registration_date` <span class="dt">DATE</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> runners</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  (`runner_id`, `registration_date`)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span>, <span class="st">'2021-01-01'</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span>, <span class="st">'2021-01-03'</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">3</span>, <span class="st">'2021-01-08'</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">4</span>, <span class="st">'2021-01-15'</span>);</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> customer_orders;</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> customer_orders (</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  `order_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  `customer_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  `pizza_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  `exclusions` <span class="dt">VARCHAR</span>(<span class="dv">4</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  `extras` <span class="dt">VARCHAR</span>(<span class="dv">4</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  `order_time` <span class="dt">TIMESTAMP</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> customer_orders</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  (`order_id`, `customer_id`, `pizza_id`, `exclusions`, `extras`, `order_time`)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'1'</span>, <span class="st">'101'</span>, <span class="st">'1'</span>, <span class="st">''</span>, <span class="st">''</span>, <span class="st">'2020-01-01 18:05:02'</span>),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2'</span>, <span class="st">'101'</span>, <span class="st">'1'</span>, <span class="st">''</span>, <span class="st">''</span>, <span class="st">'2020-01-01 19:00:52'</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'3'</span>, <span class="st">'102'</span>, <span class="st">'1'</span>, <span class="st">''</span>, <span class="st">''</span>, <span class="st">'2020-01-02 23:51:23'</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'3'</span>, <span class="st">'102'</span>, <span class="st">'2'</span>, <span class="st">''</span>, <span class="kw">NULL</span>, <span class="st">'2020-01-02 23:51:23'</span>),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'4'</span>, <span class="st">'103'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">''</span>, <span class="st">'2020-01-04 13:23:46'</span>),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'4'</span>, <span class="st">'103'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">''</span>, <span class="st">'2020-01-04 13:23:46'</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'4'</span>, <span class="st">'103'</span>, <span class="st">'2'</span>, <span class="st">'4'</span>, <span class="st">''</span>, <span class="st">'2020-01-04 13:23:46'</span>),</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5'</span>, <span class="st">'104'</span>, <span class="st">'1'</span>, <span class="st">'null'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-08 21:00:29'</span>),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'6'</span>, <span class="st">'101'</span>, <span class="st">'2'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'2020-01-08 21:03:13'</span>),</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'7'</span>, <span class="st">'105'</span>, <span class="st">'2'</span>, <span class="st">'null'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-08 21:20:29'</span>),</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'8'</span>, <span class="st">'102'</span>, <span class="st">'1'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'2020-01-09 23:54:33'</span>),</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9'</span>, <span class="st">'103'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">'1, 5'</span>, <span class="st">'2020-01-10 11:22:59'</span>),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'10'</span>, <span class="st">'104'</span>, <span class="st">'1'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'2020-01-11 18:34:49'</span>),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'10'</span>, <span class="st">'104'</span>, <span class="st">'1'</span>, <span class="st">'2, 6'</span>, <span class="st">'1, 4'</span>, <span class="st">'2020-01-11 18:34:49'</span>);</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> runner_orders;</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> runner_orders (</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  `order_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  `runner_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  `pickup_time` <span class="dt">VARCHAR</span>(<span class="dv">19</span>),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  `distance` <span class="dt">VARCHAR</span>(<span class="dv">7</span>),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  `duration` <span class="dt">VARCHAR</span>(<span class="dv">10</span>),</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  `cancellation` <span class="dt">VARCHAR</span>(<span class="dv">23</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> runner_orders</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  (`order_id`, `runner_id`, `pickup_time`, `distance`, `duration`, `cancellation`)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'1'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-01 18:15:34'</span>, <span class="st">'20km'</span>, <span class="st">'32 minutes'</span>, <span class="st">''</span>),</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-01 19:10:54'</span>, <span class="st">'20km'</span>, <span class="st">'27 minutes'</span>, <span class="st">''</span>),</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'3'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-03 00:12:37'</span>, <span class="st">'13.4km'</span>, <span class="st">'20 mins'</span>, <span class="kw">NULL</span>),</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'4'</span>, <span class="st">'2'</span>, <span class="st">'2020-01-04 13:53:03'</span>, <span class="st">'23.4'</span>, <span class="st">'40'</span>, <span class="kw">NULL</span>),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5'</span>, <span class="st">'3'</span>, <span class="st">'2020-01-08 21:10:57'</span>, <span class="st">'10'</span>, <span class="st">'15'</span>, <span class="kw">NULL</span>),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'6'</span>, <span class="st">'3'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'Restaurant Cancellation'</span>),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'7'</span>, <span class="st">'2'</span>, <span class="st">'2020-01-08 21:30:45'</span>, <span class="st">'25km'</span>, <span class="st">'25mins'</span>, <span class="st">'null'</span>),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'8'</span>, <span class="st">'2'</span>, <span class="st">'2020-01-10 00:15:02'</span>, <span class="st">'23.4 km'</span>, <span class="st">'15 minute'</span>, <span class="st">'null'</span>),</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9'</span>, <span class="st">'2'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'null'</span>, <span class="st">'Customer Cancellation'</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'10'</span>, <span class="st">'1'</span>, <span class="st">'2020-01-11 18:50:20'</span>, <span class="st">'10km'</span>, <span class="st">'10minutes'</span>, <span class="st">'null'</span>);</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> pizza_names;</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> pizza_names (</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  `pizza_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  `pizza_name` TEXT</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> pizza_names</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  (`pizza_id`, `pizza_name`)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span>, <span class="st">'Meatlovers'</span>),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span>, <span class="st">'Vegetarian'</span>);</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> pizza_recipes;</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> pizza_recipes (</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  `pizza_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  `toppings` TEXT</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> pizza_recipes</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  (`pizza_id`, `toppings`)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span>, <span class="st">'1, 2, 3, 4, 5, 6, 8, 10'</span>),</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span>, <span class="st">'4, 6, 7, 9, 11, 12'</span>);</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> pizza_toppings;</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> pizza_toppings (</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  `topping_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  `topping_name` TEXT</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> pizza_toppings</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  (`topping_id`, `topping_name`)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span>, <span class="st">'Bacon'</span>),</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span>, <span class="st">'BBQ Sauce'</span>),</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">3</span>, <span class="st">'Beef'</span>),</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">4</span>, <span class="st">'Cheese'</span>),</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">5</span>, <span class="st">'Chicken'</span>),</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">6</span>, <span class="st">'Mushrooms'</span>),</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">7</span>, <span class="st">'Onions'</span>),</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">8</span>, <span class="st">'Pepperoni'</span>),</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">9</span>, <span class="st">'Peppers'</span>),</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">10</span>, <span class="st">'Salami'</span>),</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">11</span>, <span class="st">'Tomatoes'</span>),</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">12</span>, <span class="st">'Tomato Sauce'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="case-study-questions" class="level2">
<h2 class="anchored" data-anchor-id="case-study-questions">Case Study Questions</h2>
<p>This case study has <strong>LOTS</strong> of questions - they are broken up by area of focus including:</p>
<ul>
<li><strong>Pizza Metrics</strong></li>
<li><strong>Runner and Customer Experience</strong></li>
<li><strong>Ingredient Optimisation</strong></li>
<li><strong>Pricing and Ratings</strong></li>
<li><strong>Bonus DML Challenges (DML = Data Manipulation Language)</strong></li>
</ul>
<p>Each of the following case study questions can be answered using a single SQL statement.</p>
<p>Again, there are many questions in this case study - please feel free to pick and choose which ones you’d like to try!</p>
<p>Before you start writing your SQL queries however - you might want to investigate the data, you may want to do something with some of those <code>null</code> values and data types in the <code>customer_orders</code> and <code>runner_orders</code> tables!</p>
<section id="a.-pizza-metrics" class="level3">
<h3 class="anchored" data-anchor-id="a.-pizza-metrics">A. Pizza Metrics</h3>
<ol type="1">
<li><p>How many pizzas were ordered?</p></li>
<li><p>How many unique customer orders were made?</p></li>
<li><p>How many successful orders were delivered by each runner?</p></li>
<li><p>How many of each type of pizza was delivered?</p></li>
<li><p>How many Vegetarian and Meatlovers were ordered by each customer?</p></li>
<li><p>What was the maximum number of pizzas delivered in a single order?</p></li>
<li><p>For each customer, how many delivered pizzas had at least 1 change and how many had no changes?</p></li>
<li><p>How many pizzas were delivered that had both exclusions and extras?</p></li>
<li><p>What was the total volume of pizzas ordered for each hour of the day?</p></li>
<li><p>What was the volume of orders for each day of the week?</p></li>
</ol>
</section>
<section id="b.-runner-and-customer-experience" class="level3">
<h3 class="anchored" data-anchor-id="b.-runner-and-customer-experience">B. Runner and Customer Experience</h3>
<ol type="1">
<li><p>How many runners signed up for each 1 week period? (i.e.&nbsp;week starts <code>2021-01-01</code>).</p></li>
<li><p>What was the average time in minutes it took for each runner to arrive at the Pizza Runner HQ to pickup the order?</p></li>
<li><p>Is there any relationship between the number of pizzas and how long the order takes to prepare?</p></li>
<li><p>What was the average distance travelled for each customer?</p></li>
<li><p>What was the difference between the longest and shortest delivery times for all orders?</p></li>
<li><p>What was the average speed for each runner for each delivery and do you notice any trend for these values?</p></li>
<li><p>What is the successful delivery percentage for each runner?</p></li>
</ol>
</section>
<section id="c.-ingredient-optimisation" class="level3">
<h3 class="anchored" data-anchor-id="c.-ingredient-optimisation">C. Ingredient Optimisation</h3>
<ol type="1">
<li><p>What are the standard ingredients for each pizza?</p></li>
<li><p>What was the most commonly added extra?</p></li>
<li><p>What was the most common exclusion?</p></li>
<li><p>Generate an order item for each record in the <code>customers_orders</code> table in the format of one of the following:</p>
<ul>
<li><code>Meat Lovers</code></li>
<li><code>Meat Lovers - Exclude Beef</code></li>
<li><code>Meat Lovers - Extra Bacon</code></li>
<li><code>Meat Lovers - Exclude Cheese, Bacon - Extra Mushroom, Peppers</code></li>
</ul></li>
<li><p>Generate an alphabetically ordered comma separated ingredient list for each pizza order from the <code>customer_orders</code> table and add a 2x in front of any relevant ingredients</p>
<ul>
<li><code>For example: "Meat Lovers: 2xBacon, Beef, ... , Salami"</code>.</li>
</ul></li>
<li><p>What is the total quantity of each ingredient used in all delivered pizzas sorted by most frequent first?</p></li>
</ol>
</section>
<section id="d.-pricing-and-ratings" class="level3">
<h3 class="anchored" data-anchor-id="d.-pricing-and-ratings">D. Pricing and Ratings</h3>
<ol type="1">
<li><p>If a Meat Lovers pizza costs $12 and Vegetarian costs $10 and there were no charges for changes - how much money has Pizza Runner made so far if there are no delivery fees?</p></li>
<li><p>What if there was an additional $1 charge for any pizza extras?</p>
<ul>
<li>Add cheese is $1 extra</li>
</ul></li>
<li><p>The Pizza Runner team now wants to add an additional ratings system that allows customers to rate their runner, how would you design an additional table for this new dataset - generate a schema for this new table and insert your own data for ratings for each successful customer order between 1 to 5.</p></li>
<li><p>Using your newly generated table - can you join all of the information together to form a table which has the following information for successful deliveries?</p>
<ul>
<li><code>customer_id</code></li>
<li><code>order_id</code></li>
<li><code>runner_id</code></li>
<li><code>rating</code></li>
<li><code>order_time</code></li>
<li><code>pickup_time</code></li>
<li><code>Time between order and pickup</code></li>
<li><code>Delivery duration</code></li>
<li><code>Average speed</code></li>
<li><code>Total number of pizzas</code></li>
</ul></li>
<li><p>If a Meat Lovers pizza was $12 and Vegetarian $10 fixed prices with no cost for extras and each runner is paid $0.30 per kilometre traveled - how much money does Pizza Runner have left over after these deliveries?</p></li>
</ol>
</section>
<section id="e.-bonus-questions" class="level3">
<h3 class="anchored" data-anchor-id="e.-bonus-questions">E. Bonus Questions</h3>
<p>If Danny wants to expand his range of pizzas - how would this impact the existing data design? Write an <code>INSERT</code> statement to demonstrate what would happen if a new <code>Supreme</code> pizza with all the toppings was added to the Pizza Runner menu?</p>
</section>
</section>
<section id="lets-start-solving-them." class="level2">
<h2 class="anchored" data-anchor-id="lets-start-solving-them.">Let’s start solving them.</h2>
<section id="performing-the-data-cleaning-transformations-first" class="level3">
<h3 class="anchored" data-anchor-id="performing-the-data-cleaning-transformations-first">Performing the Data Cleaning/ Transformations first!</h3>
</section>
<section id="cleaning-customer_orders-table" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-customer_orders-table">Cleaning Customer_Orders Table</h3>
<p>Dropping the customer_orders_temp table if already exists otherwise creating it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> customer_orders_temp</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> customer_orders_temp <span class="kw">AS</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> order_id, customer_id, pizza_id,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> exclusions <span class="kw">LIKE</span> <span class="st">'null'</span> <span class="cf">THEN</span> <span class="st">''</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">ELSE</span> exclusions <span class="cf">END</span> <span class="kw">AS</span> exclusions,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span> <span class="cf">WHEN</span> extras <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> extras <span class="kw">LIKE</span> <span class="st">'null'</span> <span class="cf">THEN</span> <span class="st">''</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">ELSE</span> extras <span class="cf">END</span> <span class="kw">AS</span> extras,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>order_time</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>order_id</th>
<th>customer_id</th>
<th>pizza_id</th>
<th>exclusions</th>
<th>extras</th>
<th>order_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>101</td>
<td>1</td>
<td></td>
<td></td>
<td>2020-01-01 18:05:02</td>
</tr>
<tr class="even">
<td>2</td>
<td>101</td>
<td>1</td>
<td></td>
<td></td>
<td>2020-01-01 19:00:52</td>
</tr>
<tr class="odd">
<td>3</td>
<td>102</td>
<td>1</td>
<td></td>
<td></td>
<td>2020-01-02 23:51:23</td>
</tr>
<tr class="even">
<td>3</td>
<td>102</td>
<td>2</td>
<td></td>
<td></td>
<td>2020-01-02 23:51:23</td>
</tr>
<tr class="odd">
<td>4</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td></td>
<td>2020-01-04 13:23:46</td>
</tr>
<tr class="even">
<td>4</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td></td>
<td>2020-01-04 13:23:46</td>
</tr>
<tr class="odd">
<td>4</td>
<td>103</td>
<td>2</td>
<td>4</td>
<td></td>
<td>2020-01-04 13:23:46</td>
</tr>
<tr class="even">
<td>5</td>
<td>104</td>
<td>1</td>
<td></td>
<td>1</td>
<td>2020-01-08 21:00:29</td>
</tr>
<tr class="odd">
<td>6</td>
<td>101</td>
<td>2</td>
<td></td>
<td></td>
<td>2020-01-08 21:03:13</td>
</tr>
<tr class="even">
<td>7</td>
<td>105</td>
<td>2</td>
<td></td>
<td>1</td>
<td>2020-01-08 21:20:29</td>
</tr>
<tr class="odd">
<td>8</td>
<td>102</td>
<td>1</td>
<td></td>
<td></td>
<td>2020-01-09 23:54:33</td>
</tr>
<tr class="even">
<td>9</td>
<td>103</td>
<td>1</td>
<td>4</td>
<td>1, 5</td>
<td>2020-01-10 11:22:59</td>
</tr>
<tr class="odd">
<td>10</td>
<td>104</td>
<td>1</td>
<td></td>
<td></td>
<td>2020-01-11 18:34:49</td>
</tr>
<tr class="even">
<td>10</td>
<td>104</td>
<td>1</td>
<td>2, 6</td>
<td>1, 4</td>
<td>2020-01-11 18:34:49</td>
</tr>
</tbody>
</table>
</section>
<section id="cleaning-runner_orders-table" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-runner_orders-table">Cleaning Runner_Orders Table</h3>
<p>Dropping the runner_orders_temp table if already exists otherwise creating it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> runner_orders_temp</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> runner_orders_temp <span class="kw">AS</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> order_id, runner_id,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">CAST</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> pickup_time <span class="kw">LIKE</span> <span class="ot">"null"</span> <span class="cf">THEN</span> <span class="kw">NULL</span> <span class="cf">ELSE</span> pickup_time <span class="cf">END</span> <span class="kw">AS</span> DATETIME) <span class="kw">AS</span> pickup_time,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">CAST</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> distance <span class="kw">LIKE</span> <span class="ot">"null"</span> <span class="cf">THEN</span> <span class="kw">NULL</span> <span class="cf">WHEN</span> distance <span class="kw">LIKE</span> <span class="st">'%km'</span> <span class="cf">THEN</span> <span class="fu">TRIM</span>(<span class="st">'km'</span> <span class="kw">FROM</span> distance)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> distance <span class="cf">END</span> <span class="kw">AS</span> <span class="dt">FLOAT</span>) <span class="kw">AS</span> distance,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> duration <span class="kw">LIKE</span> <span class="ot">"null"</span> <span class="cf">THEN</span> <span class="kw">NULL</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> duration <span class="kw">LIKE</span> <span class="st">'%minutes'</span> <span class="cf">THEN</span> <span class="fu">TRIM</span>(<span class="st">'minutes'</span> <span class="kw">FROM</span> duration)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> duration <span class="kw">LIKE</span> <span class="st">'%minute'</span> <span class="cf">THEN</span> <span class="fu">TRIM</span>(<span class="st">'minute'</span> <span class="kw">FROM</span> duration)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> duration <span class="kw">LIKE</span> <span class="st">'%mins'</span> <span class="cf">THEN</span> <span class="fu">TRIM</span>(<span class="st">'mins'</span> <span class="kw">FROM</span> duration)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> duration <span class="cf">END</span> <span class="kw">AS</span> <span class="dt">FLOAT</span>) <span class="kw">AS</span> duration,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> cancellation <span class="kw">IN</span> (<span class="st">''</span>, <span class="st">'null'</span>, <span class="st">'NaN'</span>) <span class="cf">THEN</span> <span class="kw">NULL</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> cancellation <span class="cf">END</span> <span class="kw">AS</span> cancellation</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Changing the Data Types of columns in runner_orders TABLE</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> runner_orders_temp</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">MODIFY</span> <span class="kw">COLUMN</span> pickup_time DATETIME,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">MODIFY</span> <span class="kw">COLUMN</span> distance <span class="dt">FLOAT</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">MODIFY</span> <span class="kw">COLUMN</span> duration <span class="dt">FLOAT</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>order_id</th>
<th>runner_id</th>
<th>pickup_time</th>
<th>distance</th>
<th>duration</th>
<th>cancellation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2020-01-01 18:15:34</td>
<td>20</td>
<td>32</td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>2020-01-01 19:10:54</td>
<td>20</td>
<td>27</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>2020-01-03 00:12:37</td>
<td>13.4</td>
<td>20</td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>2020-01-04 13:53:03</td>
<td>23.4</td>
<td>40</td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>2020-01-08 21:10:57</td>
<td>10</td>
<td>15</td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td>Restaurant Cancellation</td>
</tr>
<tr class="odd">
<td>7</td>
<td>2</td>
<td>2020-01-08 21:30:45</td>
<td>25</td>
<td>25</td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td>2</td>
<td>2020-01-10 00:15:02</td>
<td>23.4</td>
<td>15</td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td>2</td>
<td></td>
<td></td>
<td></td>
<td>Customer Cancellation</td>
</tr>
<tr class="even">
<td>10</td>
<td>1</td>
<td>2020-01-11 18:50:20</td>
<td>10</td>
<td>10</td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="a.-pizza-metrics-1" class="level2">
<h2 class="anchored" data-anchor-id="a.-pizza-metrics-1">A. Pizza Metrics</h2>
<section id="how-many-pizzas-were-ordered" class="level3">
<h3 class="anchored" data-anchor-id="how-many-pizzas-were-ordered">1. How many pizzas were ordered?</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">COUNT</span>(order_id) <span class="kw">AS</span> pizza_cnt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-pizzas-ordered" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-pizzas-ordered">Analysis of Total Pizzas Ordered</h4>
<ol type="1">
<li><p><strong>Pizza Order Overview</strong>:</p>
<ul>
<li>A total of 14 pizzas were ordered during the period under consideration.</li>
<li>Understanding the volume of pizza orders helps in assessing demand and operational requirements for Pizza Runner.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-unique-customer-orders-were-made" class="level3">
<h3 class="anchored" data-anchor-id="how-many-unique-customer-orders-were-made">2. How many unique customer orders were made?</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> order_id) <span class="kw">AS</span> unique_orders</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output: | unique_orders | |—————| | 10 |</p>
<section id="analysis-of-unique-customer-orders" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-unique-customer-orders">Analysis of Unique Customer Orders</h4>
<ol type="1">
<li><p><strong>Insights into Customer Order Frequency</strong>:</p>
<ul>
<li>A total of 10 unique customer orders were made during the specified period.</li>
<li>Understanding the frequency of unique orders provides insights into customer engagement and the overall demand for Pizza Runner’s services.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-successful-orders-were-delivered-by-each-runner" class="level3">
<h3 class="anchored" data-anchor-id="how-many-successful-orders-were-delivered-by-each-runner">3. How many successful orders were delivered by each runner?</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    runner_id,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(order_id) <span class="kw">AS</span> `successful_delivery`</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> runner_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>runner_id</th>
<th>successful_delivery</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-successful-deliveries-by-runners" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-successful-deliveries-by-runners">Analysis of Successful Deliveries by Runners</h4>
<ol type="1">
<li><p><strong>Efficiency in Order Delivery</strong>:</p>
<ul>
<li>Runner 1 completed the highest number of successful deliveries, with a total of 4 orders fulfilled.</li>
<li>Runner 2 follows closely behind, with 3 successful deliveries.</li>
<li>Runner 3 completed 1 successful delivery during the specified period.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-of-each-type-of-pizza-was-delivered" class="level3">
<h3 class="anchored" data-anchor-id="how-many-of-each-type-of-pizza-was-delivered">4. How many of each type of pizza was delivered?</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    pizza_name,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(runner_orders_temp.order_id) <span class="kw">as</span> pizza_cnt</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">ON</span> customer_orders_temp.order_id <span class="op">=</span> runner_orders_temp.order_id</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">ON</span> pizza_names.pizza_id <span class="op">=</span> customer_orders_temp.pizza_id</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> pizza_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_name</th>
<th>pizza_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Meatlovers</td>
<td>9</td>
</tr>
<tr class="even">
<td>Vegetarian</td>
<td>3</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-deliveries-by-type" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-deliveries-by-type">Analysis of Pizza Deliveries by Type</h4>
<ol type="1">
<li><p><strong>Distribution of Pizza Types</strong>:</p>
<ul>
<li>Meat Lovers pizza was the most frequently delivered, with a total of 9 orders fulfilled.</li>
<li>Vegetarian pizza accounted for a smaller portion of deliveries, with 3 orders fulfilled.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-vegetarian-and-meatlovers-were-ordered-by-each-customer" class="level3">
<h3 class="anchored" data-anchor-id="how-many-vegetarian-and-meatlovers-were-ordered-by-each-customer">5. How many Vegetarian and Meatlovers were ordered by each customer?</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    customer_id,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    pizza_name,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(order_id) <span class="kw">as</span> order_cnt</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">ON</span> customer_orders_temp.pizza_id <span class="op">=</span> pizza_names.pizza_id</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_id, pizza_name</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> customer_id, pizza_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>customer_id</th>
<th>pizza_name</th>
<th>order_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>Meatlovers</td>
<td>2</td>
</tr>
<tr class="even">
<td>101</td>
<td>Vegetarian</td>
<td>1</td>
</tr>
<tr class="odd">
<td>102</td>
<td>Meatlovers</td>
<td>2</td>
</tr>
<tr class="even">
<td>102</td>
<td>Vegetarian</td>
<td>1</td>
</tr>
<tr class="odd">
<td>103</td>
<td>Meatlovers</td>
<td>3</td>
</tr>
<tr class="even">
<td>103</td>
<td>Vegetarian</td>
<td>1</td>
</tr>
<tr class="odd">
<td>104</td>
<td>Meatlovers</td>
<td>3</td>
</tr>
<tr class="even">
<td>105</td>
<td>Vegetarian</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-orders-by-customer" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-orders-by-customer">Analysis of Pizza Orders by Customer</h4>
<ol type="1">
<li><p><strong>Customer Pizza Preferences</strong>:</p>
<ul>
<li>Customer 101 ordered 2 Meatlovers pizzas and 1 Vegetarian pizza, indicating a preference for both varieties.</li>
<li>Similarly, Customer 102 ordered 2 Meatlovers pizzas and 1 Vegetarian pizza, suggesting a balanced preference for different pizza types.</li>
<li>Customer 103 predominantly ordered Meatlovers pizzas, with 3 orders, and also ordered 1 Vegetarian pizza, indicating a preference for meat-based options but also an interest in vegetarian choices.</li>
<li>Customer 104 ordered 3 Meatlovers pizzas, indicating a strong preference for this type, while Customer 105 ordered 1 Vegetarian pizza, suggesting a preference for meat-free options.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-maximum-number-of-pizzas-delivered-in-a-single-order" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-maximum-number-of-pizzas-delivered-in-a-single-order">6. What was the maximum number of pizzas delivered in a single order?</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> customer_orders_temp.order_id,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COUNT</span>(runner_orders_temp.order_id) <span class="kw">as</span> pizza_cnt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> customer_orders_temp.order_id <span class="op">=</span> runner_orders_temp.order_id</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_orders_temp.order_id</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> pizza_cnt <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>order_id</th>
<th>pizza_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td>3</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
</tr>
<tr class="odd">
<td>10</td>
<td>2</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>5</td>
<td>1</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1</td>
</tr>
<tr class="even">
<td>7</td>
<td>1</td>
</tr>
<tr class="odd">
<td>8</td>
<td>1</td>
</tr>
<tr class="even">
<td>9</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-maximum-pizzas-delivered-in-a-single-order" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-maximum-pizzas-delivered-in-a-single-order">Analysis of Maximum Pizzas Delivered in a Single Order</h4>
<ol type="1">
<li><p><strong>Order Size Overview</strong>:</p>
<ul>
<li>Order ID 4 recorded the highest number of pizzas delivered in a single order, with 3 pizzas.</li>
<li>Orders 3 and 10 followed, each consisting of 2 pizzas, indicating moderate order sizes.</li>
<li>Several orders, including IDs 1, 2, 5, 6, 7, 8, and 9, were comprised of a single pizza, representing smaller order sizes.</li>
</ul></li>
</ol>
</section>
</section>
<section id="for-each-customer-how-many-delivered-pizzas-had-at-least-1-change-and-how-many-had-no-changes" class="level3">
<h3 class="anchored" data-anchor-id="for-each-customer-how-many-delivered-pizzas-had-at-least-1-change-and-how-many-had-no-changes">7. For each customer, how many delivered pizzas had at least 1 change and how many had no changes?</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    customer_orders_temp.customer_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions <span class="op">&lt;&gt;</span> <span class="st">''</span> <span class="kw">OR</span> extras <span class="op">&lt;&gt;</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> <span class="st">'Change'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions <span class="op">=</span> <span class="st">''</span> <span class="kw">AND</span> extras <span class="op">=</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> <span class="st">'No_Change'</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">ON</span> customer_orders_temp.order_id <span class="op">=</span> runner_orders_temp.order_id</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> runner_orders_temp.distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_orders_temp.customer_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>customer_id</th>
<th>change</th>
<th>no_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="even">
<td>102</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="odd">
<td>103</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<td>104</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>105</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-orders-with-changes" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-orders-with-changes">Analysis of Pizza Orders with Changes</h4>
<ol type="1">
<li><p><strong>Change vs.&nbsp;No Change</strong>:</p>
<ul>
<li>Customer 101 and Customer 102 placed orders without any modifications, indicating a preference for standard pizza options without exclusions or extras.</li>
<li>Customer 103 exclusively ordered pizzas with modifications, suggesting a preference for customized or personalized options tailored to specific dietary preferences or taste preferences.</li>
<li>Customer 104 had a mix of orders with and without changes, indicating a varied preference for both standard and customized pizza options.</li>
<li>Customer 105 ordered pizzas with at least one change, reflecting a preference for personalized pizza options.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-pizzas-were-delivered-that-had-both-exclusions-and-extras" class="level3">
<h3 class="anchored" data-anchor-id="how-many-pizzas-were-delivered-that-had-both-exclusions-and-extras">8. How many pizzas were delivered that had both exclusions and extras?</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    customer_orders_temp.customer_id,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions <span class="op">!=</span> <span class="st">''</span> <span class="kw">AND</span> extras <span class="op">!=</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AS</span> <span class="st">'pizza_with_exclusions_and_extras'</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">ON</span> customer_orders_temp.order_id <span class="op">=</span> runner_orders_temp.order_id</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> runner_orders_temp.pickup_time <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">AND</span> exclusions <span class="op">!=</span> <span class="st">''</span> <span class="kw">AND</span> extras <span class="op">!=</span> <span class="st">''</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_orders_temp.customer_id</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions <span class="op">!=</span> <span class="st">''</span> <span class="kw">AND</span> extras <span class="op">!=</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>)  <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>customer_id</th>
<th>pizza_with_exclusions_and_extras</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>104</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-orders-with-both-exclusions-and-extras" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-orders-with-both-exclusions-and-extras">Analysis of Pizza Orders with Both Exclusions and Extras</h4>
<ol type="1">
<li><p><strong>Pizza Customization Trends</strong>:</p>
<ul>
<li>Customer 104 placed an order that included both exclusions and extras, indicating a preference for a customized pizza with specific modifications to the standard recipe.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-total-volume-of-pizzas-ordered-for-each-hour-of-the-day" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-total-volume-of-pizzas-ordered-for-each-hour-of-the-day">9. What was the total volume of pizzas ordered for each hour of the day?</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">HOUR</span>(order_time) <span class="kw">as</span> <span class="st">'hour'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(order_id)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="kw">HOUR</span>(order_time)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="kw">HOUR</span>(order_time);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>hour</th>
<th>order_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>11</td>
<td>1</td>
</tr>
<tr class="even">
<td>13</td>
<td>3</td>
</tr>
<tr class="odd">
<td>18</td>
<td>3</td>
</tr>
<tr class="even">
<td>19</td>
<td>1</td>
</tr>
<tr class="odd">
<td>21</td>
<td>3</td>
</tr>
<tr class="even">
<td>23</td>
<td>3</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-orders-by-hour" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-orders-by-hour">Analysis of Pizza Orders by Hour</h4>
<ol type="1">
<li><p><strong>Peak Ordering Hours</strong>:</p>
<ul>
<li>Pizza orders exhibit fluctuations throughout the day, with distinct peaks during specific hours.</li>
<li>The busiest hours for pizza orders are observed between 1 PM and 3 PM, with a total volume of 3 orders during each hour.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-volume-of-orders-for-each-day-of-the-week" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-volume-of-orders-for-each-day-of-the-week">10. What was the volume of orders for each day of the week?</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    DAYNAME(order_time) <span class="kw">as</span> <span class="st">'day_of_the_week'</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(order_id)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> DAYNAME(order_time)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> DAYNAME(order_time) <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>day_of_the_week</th>
<th>order_cnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Wednesday</td>
<td>5</td>
</tr>
<tr class="even">
<td>Thursday</td>
<td>3</td>
</tr>
<tr class="odd">
<td>Saturday</td>
<td>5</td>
</tr>
<tr class="even">
<td>Friday</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-orders-by-day-of-the-week" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-orders-by-day-of-the-week">Analysis of Pizza Orders by Day of the Week</h4>
<ol type="1">
<li><p><strong>Weekday vs.&nbsp;Weekend Orders</strong>:</p>
<ul>
<li>Pizza orders exhibit variations based on the day of the week, with distinct patterns observed between weekdays and weekends.</li>
<li>Wednesdays and Saturdays emerge as the busiest days for pizza orders, with 5 orders recorded on each day.</li>
<li>Thursdays also demonstrate moderate order volume, with 3 orders placed, indicating consistent demand mid-week.</li>
<li>Fridays recorded the lowest order volume, with only 1 order registered, suggesting a dip in demand at the end of the workweek.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="b.-runner-and-customer-experience-1" class="level2">
<h2 class="anchored" data-anchor-id="b.-runner-and-customer-experience-1">B. Runner and Customer Experience</h2>
<section id="how-many-runners-signed-up-for-each-1-week-period-i.e.-week-starts-2021-01-01" class="level3">
<h3 class="anchored" data-anchor-id="how-many-runners-signed-up-for-each-1-week-period-i.e.-week-starts-2021-01-01">1. How many runners signed up for each 1 week period? (i.e.&nbsp;week starts 2021-01-01)</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    WEEK(registration_date) <span class="kw">AS</span> <span class="st">'week'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(runner_id) <span class="kw">as</span> num_of_runners</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runners</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> WEEK(registration_date);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>week</th>
<th>num_of_runners</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<section id="analysis-of-runner-sign-ups-by-week" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-runner-sign-ups-by-week">Analysis of Runner Sign-ups by Week</h4>
<ol type="1">
<li><p><strong>Weekly Runner Acquisition</strong>:</p>
<ul>
<li>Runner sign-ups fluctuate across different weeks, indicating variations in recruitment efforts and market response over time.</li>
<li>In Week 0 (starting from January 1, 2021), 1 runner signed up for Pizza Runner, marking the initial stage of recruitment.</li>
<li>Runner sign-ups increased in Week 1, with 2 new runners joining the platform, suggesting a positive response to initial marketing and recruitment initiatives.</li>
<li>However, in Week 2, the number of new sign-ups decreased to 1 runner, indicating potential challenges or fluctuations in recruitment effectiveness.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-average-time-in-minutes-it-took-for-each-runner-to-arrive-at-the-pizza-runner-hq-to-pickup-the-order" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-average-time-in-minutes-it-took-for-each-runner-to-arrive-at-the-pizza-runner-hq-to-pickup-the-order">2. What was the average time in minutes it took for each runner to arrive at the Pizza Runner HQ to pickup the order?</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> runners_pick_cte <span class="kw">AS</span> (</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> runner_id,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(TIMESTAMPDIFF(<span class="kw">MINUTE</span>, order_time, pickup_time)),<span class="dv">2</span>) <span class="kw">AS</span> avg_time</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders_temp</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> customer_orders_temp <span class="kw">ON</span> runner_orders_temp.order_id <span class="op">=</span> customer_orders_temp.order_id</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> runner_orders_temp.distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> runner_id</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">ROUND</span>(<span class="fu">AVG</span>(avg_time),<span class="dv">0</span>) <span class="kw">AS</span> avg_pick_time</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runners_pick_cte;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>avg_pickup_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>16</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-pickup-time-for-runners" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-pickup-time-for-runners">Analysis of Average Pickup Time for Runners</h4>
<ol type="1">
<li><p><strong>Average Pickup Time</strong>:</p>
<ul>
<li>The average pickup time for all runners is approximately 16 minutes, indicating the typical duration between order placement and runner arrival at the Pizza Runner HQ.</li>
<li>This metric provides insights into the efficiency of runner operations and the responsiveness of the delivery network in fulfilling customer orders promptly.</li>
</ul></li>
</ol>
</section>
</section>
<section id="is-there-any-relationship-between-the-number-of-pizzas-and-how-long-the-order-takes-to-prepare" class="level3">
<h3 class="anchored" data-anchor-id="is-there-any-relationship-between-the-number-of-pizzas-and-how-long-the-order-takes-to-prepare">3. Is there any relationship between the number of pizzas and how long the order takes to prepare?</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> order_count_cte <span class="kw">AS</span> (</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    customer_orders_temp.order_id,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(customer_orders_temp.order_id) <span class="kw">AS</span> pizza_order_count,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(TIMESTAMPDIFF(<span class="kw">MINUTE</span>, order_time, pickup_time)),<span class="dv">2</span>) <span class="kw">AS</span> avg_time_to_prepare</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders_temp</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> customer_orders_temp <span class="kw">ON</span> runner_orders_temp.order_id <span class="op">=</span> customer_orders_temp.order_id</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> pickup_time <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_orders_temp.order_id</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> pizza_order_count, <span class="fu">ROUND</span>(<span class="fu">AVG</span>(avg_time_to_prepare),<span class="dv">2</span>) <span class="kw">AS</span> avg_time_to_prepare</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> order_count_cte</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> pizza_order_count;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_order_cnt</th>
<th>avg_time_to_prepare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>12.00</td>
</tr>
<tr class="even">
<td>2</td>
<td>18.00</td>
</tr>
<tr class="odd">
<td>3</td>
<td>29.00</td>
</tr>
</tbody>
</table>
<section id="analysis-of-relationship-between-pizza-order-quantity-and-preparation-time" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-relationship-between-pizza-order-quantity-and-preparation-time">Analysis of Relationship Between Pizza Order Quantity and Preparation Time</h4>
<ol type="1">
<li><p><strong>Average Preparation Time by Pizza Quantity</strong>:</p>
<ul>
<li>Orders consisting of a single pizza have an average preparation time of approximately 12 minutes.</li>
<li>Orders with two pizzas exhibit a slightly longer average preparation time, averaging around 18 minutes.</li>
<li>Orders comprising three pizzas demonstrate the longest average preparation time, with an average of 29 minutes.</li>
</ul></li>
<li><p><strong>Potential Relationship</strong>:</p>
<ul>
<li>The analysis suggests a potential positive correlation between the quantity of pizzas in an order and the time required for preparation.</li>
<li>As the number of pizzas in an order increases, the preparation time tends to lengthen, indicating a possible relationship between order complexity and processing duration.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-average-distance-travelled-for-each-customer" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-average-distance-travelled-for-each-customer">4. What was the average distance travelled for each customer?</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    customer_orders_temp.customer_id,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(distance),<span class="dv">2</span>) <span class="kw">as</span> avg_distance</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">ON</span> customer_orders_temp.order_id <span class="op">=</span> runner_orders_temp.order_id</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> runner_orders_temp.distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> customer_orders_temp.customer_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>customer_id</th>
<th>avg_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>20</td>
</tr>
<tr class="even">
<td>102</td>
<td>16.73</td>
</tr>
<tr class="odd">
<td>103</td>
<td>23.4</td>
</tr>
<tr class="even">
<td>104</td>
<td>10</td>
</tr>
<tr class="odd">
<td>105</td>
<td>25</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-distance-travelled-by-customers" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-distance-travelled-by-customers">Analysis of Average Distance Travelled by Customers</h4>
<ol type="1">
<li><p><strong>Average Distance Travelled</strong>:</p>
<ul>
<li>Customer 101 had an average delivery distance of 20 kilometers, indicating a moderate travel distance per order.</li>
<li>Customer 102’s average delivery distance was approximately 16.73 kilometers, suggesting a slightly shorter travel distance compared to Customer 101.</li>
<li>Customer 103 had the longest average delivery distance at 23.4 kilometers, indicating a greater geographical spread of delivery locations.</li>
<li>Customer 104 had a relatively shorter average delivery distance of 10 kilometers, suggesting closer proximity to Pizza Runner HQ or a more localized customer base.</li>
<li>Customer 105 had the highest average delivery distance of 25 kilometers, indicating deliveries to more distant locations or potentially serving customers across a wider geographic area.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-difference-between-the-longest-and-shortest-delivery-times-for-all-orders" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-difference-between-the-longest-and-shortest-delivery-times-for-all-orders">5. What was the difference between the longest and shortest delivery times for all orders?</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> (<span class="fu">MAX</span>(duration) <span class="op">-</span> <span class="fu">MIN</span>(duration)) <span class="kw">AS</span> diff</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders_temp;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30</td>
</tr>
</tbody>
</table>
<section id="analysis-of-difference-between-longest-and-shortest-delivery-times" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-difference-between-longest-and-shortest-delivery-times">Analysis of Difference Between Longest and Shortest Delivery Times</h4>
<ol type="1">
<li><p><strong>Delivery Time Range</strong>:</p>
<ul>
<li>The difference between the longest and shortest delivery times for all orders was 30 minutes.</li>
<li>This variability indicates fluctuations in delivery durations across different orders, reflecting diverse factors such as distance, traffic conditions, and order complexity.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-average-speed-for-each-runner-for-each-delivery-and-do-you-notice-any-trend-for-these-values" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-average-speed-for-each-runner-for-each-delivery-and-do-you-notice-any-trend-for-these-values">6. What was the average speed for each runner for each delivery and do you notice any trend for these values?</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    RO.runner_id, RO.order_id,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(RO.distance<span class="op">/</span>(RO.duration<span class="op">/</span><span class="dv">60</span>)),<span class="dv">2</span>) <span class="kw">AS</span> average_speed_in_kmph</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders <span class="kw">AS</span> RO</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> customer_orders <span class="kw">AS</span> CO <span class="kw">ON</span> RO.order_id <span class="op">=</span> CO.order_id</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> RO.distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> RO.runner_id, RO.order_id</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> RO.runner_id, RO.order_id <span class="kw">ASC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>runner_id</th>
<th>order_id</th>
<th>average_speed_in_kmph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>37.5</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
<td>44.44</td>
</tr>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>40.2</td>
</tr>
<tr class="even">
<td>1</td>
<td>10</td>
<td>60</td>
</tr>
<tr class="odd">
<td>2</td>
<td>4</td>
<td>35.1</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td>60</td>
</tr>
<tr class="odd">
<td>2</td>
<td>8</td>
<td>93.6</td>
</tr>
<tr class="even">
<td>3</td>
<td>5</td>
<td>40</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-speed-for-each-runner" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-speed-for-each-runner">Analysis of Average Speed for Each Runner</h4>
<ol type="1">
<li><p><strong>Runner-Specific Speed Variability</strong>:</p>
<ul>
<li>The average speed for each runner varied across different deliveries, reflecting differences in route distance, traffic conditions, and delivery durations.</li>
<li>Runner 1 demonstrated varying speeds across deliveries, with average speeds ranging from 37.5 km/h to 60 km/h.</li>
<li>Runner 2 exhibited notable speed disparities, with average speeds ranging from 35.1 km/h to 93.6 km/h.</li>
<li>Runner 3 maintained a relatively consistent average speed of 40 km/h across deliveries.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-successful-delivery-percentage-for-each-runner" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-successful-delivery-percentage-for-each-runner">7. What is the successful delivery percentage for each runner?</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> runner_id,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ROUND</span>(<span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> duration <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>)<span class="op">/</span><span class="fu">COUNT</span>(runner_id),<span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span>) <span class="kw">AS</span> percentage</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runner_orders_temp</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> runner_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>runner_id</th>
<th>percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>100.00</td>
</tr>
<tr class="even">
<td>2</td>
<td>75.00</td>
</tr>
<tr class="odd">
<td>3</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<section id="analysis-of-successful-delivery-percentage-for-each-runner" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-successful-delivery-percentage-for-each-runner">Analysis of Successful Delivery Percentage for Each Runner</h4>
<ol type="1">
<li><p><strong>Runner-Specific Success Rates</strong>:</p>
<ul>
<li>Runner 1 achieved a perfect delivery success rate, with 100% of their deliveries completed successfully. This indicates consistent performance and reliability in fulfilling delivery commitments.</li>
<li>Runner 2 achieved a delivery success rate of 75%, indicating that 3 out of 4 deliveries were completed successfully. While the success rate is relatively high, there is room for improvement to enhance consistency and reliability.</li>
<li>Runner 3 achieved a delivery success rate of 50%, indicating that half of their deliveries were completed successfully. This suggests potential challenges or inconsistencies in delivery execution that may require attention.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="c.-ingredient-optimisation-1" class="level2">
<h2 class="anchored" data-anchor-id="c.-ingredient-optimisation-1">C. Ingredient Optimisation</h2>
</section>
<section id="data-cleaning-pizza_recipes-table" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-pizza_recipes-table">DATA CLEANING pizza_recipes table</h2>
<p>Dropping the pizza_recipes_temp table if already exists otherwise creating it.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> pizza_recipes_temp</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> pizza_recipes_temp <span class="kw">AS</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> pizza_id, SUBSTRING_INDEX(SUBSTRING_INDEX(toppings, <span class="st">','</span>, n), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>) <span class="kw">AS</span> topping_id</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> pizza_recipes</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">AS</span> n</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">2</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">3</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">4</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">5</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">6</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">7</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">8</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">9</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">10</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> numbers <span class="kw">ON</span> CHAR_LENGTH(toppings) <span class="op">-</span> CHAR_LENGTH(<span class="kw">REPLACE</span>(toppings, <span class="st">','</span>, <span class="st">''</span>)) <span class="op">&gt;=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> pizza_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_id</th>
<th>topping_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td>1</td>
<td>6</td>
</tr>
<tr class="odd">
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td>1</td>
<td>10</td>
</tr>
<tr class="odd">
<td>2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>6</td>
</tr>
<tr class="odd">
<td>2</td>
<td>7</td>
</tr>
<tr class="even">
<td>2</td>
<td>9</td>
</tr>
<tr class="odd">
<td>2</td>
<td>11</td>
</tr>
<tr class="even">
<td>2</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>Generating a unique row number to identify each record</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> customer_orders_temp</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> <span class="kw">COLUMN</span> record_id <span class="dt">INT</span> AUTO_INCREMENT <span class="kw">PRIMARY</span> <span class="kw">KEY</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Breaking the Extras Column in Customer_Orders_Temp Table</p>
<p>Assuming your original table is named ‘customer_orders_temp’ and the column is ’extras. Create a temporary table for the exploded extras using a subquery</p>
<p>Dropping the extrasBreak, extrasBreak_ tables if already exists otherwise creating them.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> extrasBreak, extrasBreak_</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> extrasBreak <span class="kw">AS</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, <span class="fu">TRIM</span>(<span class="fu">value</span>) <span class="kw">AS</span> extra_id</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ( <span class="kw">SELECT</span> record_id,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(extras, <span class="st">','</span>, n.digit <span class="op">+</span> <span class="dv">1</span>), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="kw">AS</span> <span class="fu">value</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> (</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> <span class="dv">0</span> <span class="kw">AS</span> digit <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">2</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">3</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">4</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    ) n <span class="kw">ON</span> CHAR_LENGTH(extras) <span class="op">-</span> CHAR_LENGTH(<span class="kw">REPLACE</span>(extras, <span class="st">','</span>, <span class="st">''</span>)) <span class="op">&gt;=</span> n.digit</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> <span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(extras, <span class="st">','</span>, n.digit <span class="op">+</span> <span class="dv">1</span>), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="op">&lt;&gt;</span> <span class="st">''</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> e;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Add rows with null or empty values</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> extrasBreak (record_id, extra_id)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, <span class="kw">NULL</span> <span class="kw">AS</span> extra_id</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> extras <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> <span class="fu">TRIM</span>(extras) <span class="op">=</span> <span class="st">''</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Creating a temporary table extrasBreak_</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> extrasBreak_ <span class="kw">AS</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> extra_id <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="st">''</span> <span class="cf">ELSE</span> extra_id <span class="cf">END</span> <span class="kw">AS</span> extra_id</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> extrasBreak</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> record_id, extra_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output of extraBreak_ table:</p>
<table class="table">
<thead>
<tr class="header">
<th>record_id</th>
<th>extra_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td></td>
</tr>
<tr class="odd">
<td>7</td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td>1</td>
</tr>
<tr class="odd">
<td>9</td>
<td></td>
</tr>
<tr class="even">
<td>10</td>
<td>1</td>
</tr>
<tr class="odd">
<td>11</td>
<td></td>
</tr>
<tr class="even">
<td>12</td>
<td>1</td>
</tr>
<tr class="odd">
<td>12</td>
<td>5</td>
</tr>
<tr class="even">
<td>13</td>
<td></td>
</tr>
<tr class="odd">
<td>14</td>
<td>1</td>
</tr>
<tr class="even">
<td>14</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Breaking the Exclusion Column in Customer_Orders_Temp Table</p>
<p>Assuming your original table is named ‘customer_orders_temp’ and the column is ‘exclusions’. Create a temporary table for the exploded exclusions using a subquery</p>
<p>Dropping the exclusionsBreak, exclusionsBreak_ tables if already exists otherwise creating them.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> exclusionsBreak, exclusionsBreak_</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> exclusionsBreak <span class="kw">AS</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, <span class="fu">TRIM</span>(<span class="fu">value</span>) <span class="kw">AS</span> exclusions_id</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ( <span class="kw">SELECT</span> record_id,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(exclusions, <span class="st">','</span>, n.digit <span class="op">+</span> <span class="dv">1</span>), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="kw">AS</span> <span class="fu">value</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> (</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> <span class="dv">0</span> <span class="kw">AS</span> digit <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">2</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">3</span> <span class="kw">UNION</span> <span class="kw">ALL</span> <span class="kw">SELECT</span> <span class="dv">4</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    ) n <span class="kw">ON</span> CHAR_LENGTH(exclusions) <span class="op">-</span> CHAR_LENGTH(<span class="kw">REPLACE</span>(exclusions, <span class="st">','</span>, <span class="st">''</span>)) <span class="op">&gt;=</span> n.digit</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> <span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(exclusions, <span class="st">','</span>, n.digit <span class="op">+</span> <span class="dv">1</span>), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="op">&lt;&gt;</span> <span class="st">''</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> e;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Add rows with null or empty values</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> exclusionsBreak (record_id, exclusions_id)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, <span class="kw">NULL</span> <span class="kw">AS</span> exclusions_id</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> exclusions <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> <span class="fu">TRIM</span>(exclusions) <span class="op">=</span> <span class="st">''</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Creating a temporary table exclusionsBreak_</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> exclusionsBreak_ <span class="kw">AS</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> exclusions_id <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="st">''</span> <span class="cf">ELSE</span> exclusions_id <span class="cf">END</span> <span class="kw">AS</span> exclusions_id</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> exclusionsBreak</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> record_id, exclusions_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output of exclusionsBreak_ table:</p>
<table class="table">
<thead>
<tr class="header">
<th>record_id</th>
<th>exclusions_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
</tr>
<tr class="even">
<td>6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>7</td>
<td>4</td>
</tr>
<tr class="even">
<td>8</td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td></td>
</tr>
<tr class="even">
<td>10</td>
<td></td>
</tr>
<tr class="odd">
<td>11</td>
<td></td>
</tr>
<tr class="even">
<td>12</td>
<td>4</td>
</tr>
<tr class="odd">
<td>13</td>
<td></td>
</tr>
<tr class="even">
<td>14</td>
<td>2</td>
</tr>
<tr class="odd">
<td>14</td>
<td>6</td>
</tr>
</tbody>
</table>
<section id="what-are-the-standard-ingredients-for-each-pizza" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-standard-ingredients-for-each-pizza">1. What are the standard ingredients for each pizza?</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    pizza_names.pizza_id,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    pizza_names.pizza_name,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    GROUP_CONCAT(<span class="kw">DISTINCT</span> topping_name) <span class="kw">AS</span> topping_name_</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> pizza_names</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_recipes_temp <span class="kw">ON</span> pizza_names.pizza_id <span class="op">=</span> pizza_recipes.pizza_id</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_toppings <span class="kw">ON</span> pizza_recipes.topping_id <span class="op">=</span> pizza_toppings.topping_id</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> pizza_names.pizza_id,pizza_names.pizza_name</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> pizza_names.pizza_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>pizza_id</th>
<th>pizza_name</th>
<th>topping_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Meatlovers</td>
<td>Bacon, BBQ Sauce, Beef, Cheese, Chicken, Mushrooms, Pepperoni, Salami</td>
</tr>
<tr class="even">
<td>2</td>
<td>Vegetarian</td>
<td>Cheese, Mushrooms, Onions, Peppers, Tomato Sauce, Tomatoes</td>
</tr>
</tbody>
</table>
<section id="analysis-of-standard-ingredients-for-each-pizza" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-standard-ingredients-for-each-pizza">Analysis of Standard Ingredients for Each Pizza</h4>
<ol type="1">
<li><p><strong>Pizza Ingredients Overview</strong>:</p>
<p>A. <strong>Meatlovers Pizza</strong>:</p>
<ul>
<li>Standard ingredients for Meatlovers pizza include Bacon, BBQ Sauce, Beef, Cheese, Chicken, Mushrooms, Pepperoni, and Salami.</li>
<li>These ingredients typically cater to customers who prefer meat-based toppings on their pizzas.</li>
</ul>
<p>B. <strong>Vegetarian Pizza</strong>:</p>
<ul>
<li>Standard ingredients for Vegetarian pizza consist of Cheese, Mushrooms, Onions, Peppers, Tomato Sauce, and Tomatoes.</li>
<li>This pizza variant is suitable for customers who prefer vegetarian options, offering a mix of flavorful vegetables and cheese.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-most-commonly-added-extra" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-most-commonly-added-extra">2. What was the most commonly added extra?</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cte <span class="kw">AS</span> (</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> order_id,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">CAST</span>(<span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(extras, <span class="st">','</span>, n), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="kw">AS</span> UNSIGNED) <span class="kw">AS</span> topping_id</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> ( <span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">AS</span> n</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>       <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">2</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> numbers <span class="kw">ON</span> CHAR_LENGTH(extras) <span class="op">-</span> CHAR_LENGTH(<span class="kw">REPLACE</span>(extras, <span class="st">','</span>, <span class="st">''</span>)) <span class="op">&gt;=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> extras <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> topping_name, <span class="fu">COUNT</span>(order_id) <span class="kw">AS</span> most_common_extras</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cte <span class="kw">JOIN</span> pizza_toppings <span class="kw">ON</span> pizza_toppings.topping_id <span class="op">=</span> cte.topping_id</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> topping_name <span class="kw">LIMIT</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>topping_name</th>
<th>most_common_extras</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bacon</td>
<td>4</td>
</tr>
</tbody>
</table>
<section id="analysis-of-most-commonly-added-extra" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-most-commonly-added-extra">Analysis of Most Commonly Added Extra</h4>
<ol type="1">
<li><p><strong>Most Common Extra Topping</strong>:</p>
<ul>
<li>Bacon: The data reveals that bacon is the most frequently added extra topping by customers, with a count of 4 orders.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-most-common-exclusion" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-most-common-exclusion">3. What was the most common exclusion?</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cte <span class="kw">AS</span> (</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> order_id,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">CAST</span>(<span class="fu">TRIM</span>(SUBSTRING_INDEX(SUBSTRING_INDEX(exclusions, <span class="st">','</span>, n), <span class="st">','</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="kw">AS</span> UNSIGNED) <span class="kw">AS</span> topping_id</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> ( <span class="kw">SELECT</span> <span class="dv">1</span> <span class="kw">AS</span> n</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="dv">2</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> numbers <span class="kw">ON</span> CHAR_LENGTH(exclusions) <span class="op">-</span> CHAR_LENGTH(<span class="kw">REPLACE</span>(exclusions, <span class="st">','</span>, <span class="st">''</span>)) <span class="op">&gt;=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> exclusions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> topping_name, <span class="fu">COUNT</span>(order_id) <span class="kw">AS</span> most_common_exclusions</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cte <span class="kw">JOIN</span> pizza_toppings <span class="kw">ON</span> pizza_toppings.topping_id <span class="op">=</span> cte.topping_id</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> topping_name <span class="kw">LIMIT</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>topping_name</th>
<th>most_common_exclusions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cheese</td>
<td>4</td>
</tr>
</tbody>
</table>
<section id="analysis-of-most-common-exclusion" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-most-common-exclusion">Analysis of Most Common Exclusion</h4>
<ol type="1">
<li><p><strong>Most Common Exclusion</strong>:</p>
<ul>
<li>Cheese: The analysis reveals that cheese is the most frequently excluded ingredient, with a count of 4 orders.</li>
</ul></li>
</ol>
</section>
</section>
<section id="generate-an-order-item-for-each-record-in-the-customers_orders-table-in-the-format-of-one-of-the-following" class="level3">
<h3 class="anchored" data-anchor-id="generate-an-order-item-for-each-record-in-the-customers_orders-table-in-the-format-of-one-of-the-following">4. Generate an order item for each record in the customers_orders table in the format of one of the following:</h3>
<ul>
<li><strong><code>Meat Lovers</code></strong></li>
<li><strong><code>Meat Lovers - Exclude Beef</code></strong></li>
<li><strong><code>Meat Lovers - Extra Bacon</code></strong></li>
<li><strong><code>Meat Lovers - Exclude Cheese, Bacon - Extra Mushroom, Peppers</code></strong></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> extras_cte <span class="kw">AS</span> (</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, GROUP_CONCAT(<span class="st">'Extra '</span>, PT.topping_name) <span class="kw">AS</span> option_text</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> extrasBreak_ <span class="kw">AS</span> EB <span class="kw">JOIN</span> pizza_toppings <span class="kw">AS</span> PT <span class="kw">ON</span> EB.extra_id <span class="op">=</span> PT.topping_id <span class="kw">GROUP</span> <span class="kw">BY</span> record_id</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>exclusions_cte <span class="kw">AS</span> (</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> record_id, GROUP_CONCAT(<span class="st">'Exclusion '</span>, PT.topping_name) <span class="kw">AS</span> option_text</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> exclusionsBreak_ <span class="kw">AS</span> EB <span class="kw">JOIN</span> pizza_toppings <span class="kw">AS</span> PT <span class="kw">ON</span> EB.exclusions_id <span class="op">=</span> PT.topping_id</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> record_id</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>combined_cte <span class="kw">AS</span> (</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> extras_cte <span class="kw">UNION</span> <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> exclusions_cte</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>partial_data_cte <span class="kw">AS</span> (</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> CO.record_id, CO.order_id, CO.customer_id, CO.pizza_id, CO.order_time,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    IFNULL(GROUP_CONCAT(PN.pizza_name, <span class="st">' - '</span>, option_text), <span class="st">''</span>) <span class="kw">AS</span> pizza_details</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO <span class="kw">LEFT</span> <span class="kw">JOIN</span> combined_cte <span class="kw">AS</span> CC <span class="kw">ON</span> CO.record_id <span class="op">=</span> CC.record_id</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">AS</span> PN <span class="kw">ON</span> PN.pizza_id <span class="op">=</span> CO.pizza_id</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> CO.record_id, CO.order_id, CO.customer_id, CO.pizza_id, CO.order_time</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PDC.record_id, PDC.order_id, PDC.customer_id, PDC.pizza_id, PDC.order_time,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> PDC.pizza_id <span class="op">=</span> <span class="st">'1'</span> <span class="kw">AND</span> pizza_details <span class="op">=</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="st">'MeatLover'</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>         <span class="cf">WHEN</span> PDC.pizza_id <span class="op">=</span> <span class="st">'2'</span> <span class="kw">AND</span> pizza_details <span class="op">=</span> <span class="st">''</span> <span class="cf">THEN</span> <span class="st">'Vegetarian'</span> <span class="cf">ELSE</span> PDC.pizza_details <span class="cf">END</span> <span class="kw">AS</span> pizza_detail</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> partial_data_cte <span class="kw">AS</span> PDC;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>record_id</th>
<th>order_id</th>
<th>customer_id</th>
<th>pizza_id</th>
<th>order_time</th>
<th>pizza_detail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>101</td>
<td>1</td>
<td>2020-01-01 18:05:02</td>
<td>MeatLover</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>101</td>
<td>1</td>
<td>2020-01-01 19:00:52</td>
<td>MeatLover</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>102</td>
<td>1</td>
<td>2020-01-02 23:51:23</td>
<td>MeatLover</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>102</td>
<td>2</td>
<td>2020-01-02 23:51:23</td>
<td>Vegetarian</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>103</td>
<td>1</td>
<td>2020-01-04 13:23:46</td>
<td>Meatlovers - Exclusion Cheese</td>
</tr>
<tr class="even">
<td>6</td>
<td>4</td>
<td>103</td>
<td>1</td>
<td>2020-01-04 13:23:46</td>
<td>Meatlovers - Exclusion Cheese</td>
</tr>
<tr class="odd">
<td>7</td>
<td>4</td>
<td>103</td>
<td>2</td>
<td>2020-01-04 13:23:46</td>
<td>Vegetarian - Exclusion Cheese</td>
</tr>
<tr class="even">
<td>8</td>
<td>5</td>
<td>104</td>
<td>1</td>
<td>2020-01-08 21:00:29</td>
<td>Meatlovers - Extra Bacon</td>
</tr>
<tr class="odd">
<td>9</td>
<td>6</td>
<td>101</td>
<td>2</td>
<td>2020-01-08 21:03:13</td>
<td>Vegetarian</td>
</tr>
<tr class="even">
<td>10</td>
<td>7</td>
<td>105</td>
<td>2</td>
<td>2020-01-08 21:20:29</td>
<td>Vegetarian - Extra Bacon</td>
</tr>
<tr class="odd">
<td>11</td>
<td>8</td>
<td>102</td>
<td>1</td>
<td>2020-01-09 23:54:33</td>
<td>MeatLover</td>
</tr>
<tr class="even">
<td>12</td>
<td>9</td>
<td>103</td>
<td>1</td>
<td>2020-01-10 11:22:59</td>
<td>Meatlovers - Extra Bacon, Extra Chicken, Meatlovers - Exclusion Cheese</td>
</tr>
<tr class="odd">
<td>13</td>
<td>10</td>
<td>104</td>
<td>1</td>
<td>2020-01-11 18:34:49</td>
<td>MeatLover</td>
</tr>
<tr class="even">
<td>14</td>
<td>10</td>
<td>104</td>
<td>1</td>
<td>2020-01-11 18:34:49</td>
<td>Meatlovers - Extra Bacon, Extra Cheese, Meatlovers - Exclusion BBQ Sauce, Exclusion Mushrooms</td>
</tr>
</tbody>
</table>
</section>
<section id="generate-an-alphabetically-ordered-comma-separated-ingredient-list-for-each-pizza-order-from-the-customer_orders-table-and-add-a-2x-in-front-of-any-relevant-ingredients." class="level3">
<h3 class="anchored" data-anchor-id="generate-an-alphabetically-ordered-comma-separated-ingredient-list-for-each-pizza-order-from-the-customer_orders-table-and-add-a-2x-in-front-of-any-relevant-ingredients.">5. Generate an alphabetically ordered comma separated ingredient list for each pizza order from the customer_orders table and add a 2x in front of any relevant ingredients.</h3>
<ul>
<li>For example: “Meat Lovers: 2xBacon, Beef, … , Salami”.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> pizza_ingredients <span class="kw">AS</span> (</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> CO.record_id, CO.order_id, CO.customer_id, CO.pizza_id, CO.order_time, PN.pizza_name,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">CASE</span> <span class="cf">WHEN</span> PT.topping_id <span class="kw">IN</span> (<span class="kw">SELECT</span> extra_id <span class="kw">FROM</span> extrasBreak_ <span class="kw">AS</span> EB1 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB1.record_id)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">THEN</span> <span class="fu">CONCAT</span>(<span class="st">'2x '</span>, PT.topping_name) <span class="cf">ELSE</span> PT.topping_name <span class="cf">END</span> <span class="kw">AS</span> ingredients_used</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO <span class="kw">JOIN</span> pizza_recipes_temp <span class="kw">AS</span> PR <span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PR.pizza_id</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> pizza_toppings <span class="kw">AS</span> PT <span class="kw">ON</span> PT.topping_id <span class="op">=</span> PR.topping_id</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> pizza_names <span class="kw">AS</span> PN <span class="kw">ON</span> PN.pizza_id <span class="op">=</span> CO.pizza_id</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> PR.topping_id <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> exclusions_id <span class="kw">FROM</span> exclusionsBreak_ <span class="kw">AS</span> EB2 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB2.record_id)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PI.record_id, PI.order_id, PI.customer_id, PI.pizza_id, PI.order_time,<span class="fu">CONCAT</span>(PI.pizza_name, <span class="st">': '</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        GROUP_CONCAT(ingredients_used <span class="kw">ORDER</span> <span class="kw">BY</span> ingredients_used)) <span class="kw">AS</span> ingredients_used</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> pizza_ingredients <span class="kw">AS</span> PI</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PI.record_id, PI.order_id, PI.customer_id, PI.pizza_id, PI.order_time, PI.pizza_name</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> PI.record_id, PI.order_id, PI.customer_id, PI.pizza_id, PI.order_time;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>record_id</th>
<th>order_id</th>
<th>customer_id</th>
<th>pizza_id</th>
<th>order_time</th>
<th>ingredients_used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>101</td>
<td>1</td>
<td>2020-01-01 18:05:02</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>101</td>
<td>1</td>
<td>2020-01-01 19:00:52</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>102</td>
<td>1</td>
<td>2020-01-02 23:51:23</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>102</td>
<td>2</td>
<td>2020-01-02 23:51:23</td>
<td>Vegetarian: Cheese,Mushrooms,Onions,Peppers,Tomato Sauce,Tomatoes</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>103</td>
<td>1</td>
<td>2020-01-04 13:23:46</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="even">
<td>6</td>
<td>4</td>
<td>103</td>
<td>1</td>
<td>2020-01-04 13:23:46</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="odd">
<td>7</td>
<td>4</td>
<td>103</td>
<td>2</td>
<td>2020-01-04 13:23:46</td>
<td>Vegetarian: Mushrooms,Onions,Peppers,Tomato Sauce,Tomatoes</td>
</tr>
<tr class="even">
<td>8</td>
<td>5</td>
<td>104</td>
<td>1</td>
<td>2020-01-08 21:00:29</td>
<td>Meatlovers: 2x Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="odd">
<td>9</td>
<td>6</td>
<td>101</td>
<td>2</td>
<td>2020-01-08 21:03:13</td>
<td>Vegetarian: Cheese,Mushrooms,Onions,Peppers,Tomato Sauce,Tomatoes</td>
</tr>
<tr class="even">
<td>10</td>
<td>7</td>
<td>105</td>
<td>2</td>
<td>2020-01-08 21:20:29</td>
<td>Vegetarian: Cheese,Mushrooms,Onions,Peppers,Tomato Sauce,Tomatoes</td>
</tr>
<tr class="odd">
<td>11</td>
<td>8</td>
<td>102</td>
<td>1</td>
<td>2020-01-09 23:54:33</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="even">
<td>12</td>
<td>9</td>
<td>103</td>
<td>1</td>
<td>2020-01-10 11:22:59</td>
<td>Meatlovers: 2x Bacon,2x Chicken,BBQ Sauce,Beef,Cheese,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="odd">
<td>13</td>
<td>10</td>
<td>104</td>
<td>1</td>
<td>2020-01-11 18:34:49</td>
<td>Meatlovers: Bacon,BBQ Sauce,Beef,Cheese,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
<tr class="even">
<td>14</td>
<td>10</td>
<td>104</td>
<td>1</td>
<td>2020-01-11 18:34:49</td>
<td>Meatlovers: 2x Bacon,2x Cheese,BBQ Sauce,Beef,Chicken,Mushrooms,Pepperoni,Salami</td>
</tr>
</tbody>
</table>
</section>
<section id="what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first">6. What is the total quantity of each ingredient used in all delivered pizzas sorted by most frequent first?</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> pizza_ingredients <span class="kw">AS</span> (</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> CO.order_id, CO.customer_id, PT.topping_name,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> PR.topping_id <span class="kw">IN</span> (<span class="kw">SELECT</span> extra_id <span class="kw">FROM</span> extrasBreak_ <span class="kw">AS</span> EB1 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB1.record_id) <span class="cf">THEN</span> <span class="dv">2</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> PR.topping_id <span class="kw">IN</span> (<span class="kw">SELECT</span> exclusions_id <span class="kw">FROM</span> exclusionsBreak_ <span class="kw">AS</span> EB2 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB2.record_id) <span class="cf">THEN</span> <span class="dv">0</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="dv">1</span> <span class="cf">END</span> <span class="kw">AS</span> ingredients_used</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO <span class="kw">JOIN</span> pizza_recipes_temp <span class="kw">AS</span> PR</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PR.pizza_id <span class="kw">JOIN</span> pizza_toppings <span class="kw">AS</span> PT</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> PT.topping_id <span class="op">=</span> PR.topping_id</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PI.topping_name, <span class="fu">SUM</span>(ingredients_used) <span class="kw">AS</span> qty_used_of_each_ingredients <span class="kw">FROM</span> pizza_ingredients <span class="kw">AS</span> PI</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PI.topping_name</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> PI.topping_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>topping_name</th>
<th>qty_used_of_each_ingredients</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bacon</td>
<td>13</td>
</tr>
<tr class="even">
<td>BBQ Sauce</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Beef</td>
<td>10</td>
</tr>
<tr class="even">
<td>Cheese</td>
<td>13</td>
</tr>
<tr class="odd">
<td>Chicken</td>
<td>10</td>
</tr>
<tr class="even">
<td>Mushrooms</td>
<td>14</td>
</tr>
<tr class="odd">
<td>Onions</td>
<td>4</td>
</tr>
<tr class="even">
<td>Pepperoni</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Peppers</td>
<td>4</td>
</tr>
<tr class="even">
<td>Salami</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Tomato Sauce</td>
<td>4</td>
</tr>
<tr class="even">
<td>Tomatoes</td>
<td>4</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-ingredient-usage-in-pizzas" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-ingredient-usage-in-pizzas">Analysis of Total Ingredient Usage in Pizzas</h4>
<ol type="1">
<li><p><strong>Ingredient Usage Overview</strong>:</p>
<ul>
<li><p>Mushrooms: Mushrooms emerge as the most frequently used ingredient, with a total quantity of 14 units across all delivered pizzas.</p></li>
<li><p>Bacon, Cheese: Bacon and cheese follow closely behind, with both ingredients utilized in 13 units of pizzas each.</p></li>
<li><p>BBQ Sauce, Beef, Chicken, Pepperoni, Salami: These ingredients are also commonly used, each appearing in 10 units of pizzas.</p></li>
<li><p>Onions, Peppers, Tomato Sauce, Tomatoes: These ingredients have a relatively lower usage frequency, each appearing in 4 units of pizzas.</p></li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="d.-pricing-and-ratings-1" class="level2">
<h2 class="anchored" data-anchor-id="d.-pricing-and-ratings-1">D. Pricing and Ratings</h2>
<section id="if-a-meat-lovers-pizza-costs-12-and-vegetarian-costs-10-and-there-were-no-charges-for-changes---how-much-money-has-pizza-runner-made-so-far-if-there-are-no-delivery-fees" class="level3">
<h3 class="anchored" data-anchor-id="if-a-meat-lovers-pizza-costs-12-and-vegetarian-costs-10-and-there-were-no-charges-for-changes---how-much-money-has-pizza-runner-made-so-far-if-there-are-no-delivery-fees">1. If a Meat Lovers pizza costs $12 and Vegetarian costs $10 and there were no charges for changes - how much money has Pizza Runner made so far if there are no delivery fees?</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> PN.pizza_name <span class="op">=</span> <span class="st">'Meatlovers'</span> <span class="cf">THEN</span> <span class="dv">12</span> <span class="cf">ELSE</span> <span class="dv">10</span> <span class="cf">END</span>) <span class="kw">AS</span> Total_revenue</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">AS</span> RO <span class="kw">ON</span> CO.order_id <span class="op">=</span> RO.order_id</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">AS</span> PN <span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PN.pizza_id</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> RO.distance <span class="op">!=</span> <span class="dv">0</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output: | Total_revenue | |—————| | 138 |</p>
<section id="analysis-of-pizza-runners-revenue" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-runners-revenue">Analysis of Pizza Runner’s Revenue</h4>
<ol type="1">
<li><p><strong>Revenue Overview</strong>:</p>
<ul>
<li>Total Revenue: $138</li>
</ul></li>
<li><p><strong>Revenue Contribution</strong>:</p>
<ul>
<li>Meat Lovers pizzas, priced at $12 each, contributed significantly to Pizza Runner’s revenue, generating a substantial portion of the total revenue.</li>
</ul></li>
<li><p><strong>Pricing Strategy</strong>:</p>
<ul>
<li>The pricing strategy of offering Meat Lovers and Vegetarian pizzas at $12 and $10, respectively, appears to align with customer preferences and market demand. The differential pricing reflects the perceived value of the pizzas and encourages customers to opt for higher-priced options.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-if-there-was-an-additional-1-charge-for-any-pizza-extras-add-cheese-is-1-extra" class="level3">
<h3 class="anchored" data-anchor-id="what-if-there-was-an-additional-1-charge-for-any-pizza-extras-add-cheese-is-1-extra">2. What if there was an additional $1 charge for any pizza extras? (Add cheese is $1 extra)</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> pizza_name <span class="op">=</span> <span class="st">'Meatlovers'</span> <span class="kw">AND</span> extra_one_dollar_charge <span class="op">=</span> <span class="st">'1'</span> <span class="cf">THEN</span> (<span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> pizza_name <span class="op">=</span> <span class="st">'Meatlovers'</span> <span class="kw">AND</span> extra_one_dollar_charge <span class="op">=</span> <span class="st">'2'</span> <span class="cf">THEN</span> (<span class="dv">12</span> <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> pizza_name <span class="op">=</span> <span class="st">'Vegetarian'</span> <span class="kw">AND</span> extra_one_dollar_charge <span class="op">=</span> <span class="st">'1'</span> <span class="cf">THEN</span> (<span class="dv">10</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> pizza_name <span class="op">=</span> <span class="st">'Vegetarian'</span> <span class="kw">AND</span> extra_one_dollar_charge <span class="op">=</span> <span class="st">'2'</span> <span class="cf">THEN</span> (<span class="dv">10</span> <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span>) <span class="kw">AS</span> Total_revenue</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        CO.order_id, CO.customer_id, CO.pizza_id, RO.distance,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        PN.pizza_name, </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        (<span class="cf">CASE</span> <span class="cf">WHEN</span> extras <span class="kw">LIKE</span> <span class="st">'%4%'</span> <span class="cf">THEN</span> <span class="dv">2</span> <span class="cf">ELSE</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> extra_one_dollar_charge</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">AS</span> RO</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> CO.order_id <span class="op">=</span> RO.order_id</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">AS</span> PN</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PN.pizza_id</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> RO.distance <span class="op">!=</span> <span class="dv">0</span>) <span class="kw">AS</span> temp_;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>Total_revenue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>151</td>
</tr>
</tbody>
</table>
<section id="analysis-of-pizza-runners-revenue-with-extra-charge-for-pizza-extras" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-pizza-runners-revenue-with-extra-charge-for-pizza-extras">Analysis of Pizza Runner’s Revenue with Extra Charge for Pizza Extras</h4>
<ol type="1">
<li><p><strong>Revenue Overview:</strong>:</p>
<ul>
<li>Total Revenue with Extra Charge: $151</li>
</ul></li>
<li><p><strong>Impact of Extra Charge</strong>:</p>
<ul>
<li>Introducing an additional $1 charge for pizza extras, particularly for adding cheese, resulted in a slight increase in total revenue compared to the previous scenario.</li>
</ul></li>
</ol>
</section>
</section>
<section id="the-pizza-runner-team-now-wants-to-add-an-additional-ratings-system-that-allows-customers-to-rate-their-runner-how-would-you-design-an-additional-table-for-this-new-dataset---generate-a-schema-for-this-new-table-and-insert-your-own-data-for-ratings-for-each-successful-customer-order-between-1-to-5." class="level3">
<h3 class="anchored" data-anchor-id="the-pizza-runner-team-now-wants-to-add-an-additional-ratings-system-that-allows-customers-to-rate-their-runner-how-would-you-design-an-additional-table-for-this-new-dataset---generate-a-schema-for-this-new-table-and-insert-your-own-data-for-ratings-for-each-successful-customer-order-between-1-to-5.">3. The Pizza Runner team now wants to add an additional ratings system that allows customers to rate their runner, how would you design an additional table for this new dataset - generate a schema for this new table and insert your own data for ratings for each successful customer order between 1 to 5.</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> ratings;</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> ratings (</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    order_id <span class="dt">INT</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    ratings <span class="dt">INT</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> ratings (order_id, ratings)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- Inserting some random ratings</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span> (<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">7</span>,<span class="dv">2</span>),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">8</span>,<span class="dv">4</span>),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">10</span>,<span class="dv">3</span>);</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> ratings;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>order_id</th>
<th>ratings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td>7</td>
<td>2</td>
</tr>
<tr class="odd">
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td>10</td>
<td>3</td>
</tr>
</tbody>
</table>
</section>
<section id="using-your-newly-generated-table---can-you-join-all-of-the-information-together-to-form-a-table-which-has-the-following-information-for-successful-deliveries" class="level3">
<h3 class="anchored" data-anchor-id="using-your-newly-generated-table---can-you-join-all-of-the-information-together-to-form-a-table-which-has-the-following-information-for-successful-deliveries">4. Using your newly generated table - can you join all of the information together to form a table which has the following information for successful deliveries?</h3>
<pre><code>- customer_id, order_id, runner_id, rating, order_time, pickup_time, Time between order and pickup, Delivery duration, Average speed, Total number of pizzas.</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    CO.customer_id, CO.order_id, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    RO.runner_id, R.ratings, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    CO.order_time, RO.duration,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(TIME_TO_SEC(TIMEDIFF(RO.pickup_time, CO.order_time))<span class="op">/</span><span class="dv">60</span>,<span class="dv">0</span>) <span class="kw">AS</span> time_between_order_and_pickup_in_minutes,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(RO.distance<span class="op">/</span>(RO.duration<span class="op">/</span><span class="dv">60</span>)),<span class="dv">2</span>) <span class="kw">AS</span> average_speed_in_kmph,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(CO.order_id) <span class="kw">AS</span> pizza_count</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">AS</span> RO <span class="kw">ON</span> CO.order_id <span class="op">=</span> RO.order_id</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> ratings <span class="kw">AS</span> R <span class="kw">ON</span> RO.order_id <span class="op">=</span> R.order_id</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> RO.distance <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> CO.customer_id, CO.order_id, RO.runner_id, R.ratings, CO.order_time,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    RO.duration, time_between_order_and_pickup_in_minutes;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 26%">
<col style="width: 13%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>customer_id</th>
<th>order_id</th>
<th>runner_id</th>
<th>ratings</th>
<th>order_time</th>
<th>distance</th>
<th>duration</th>
<th>time_between_order_and_pickup_in_minutes</th>
<th>average_speed_in_kmph</th>
<th>pizza_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>2020-01-01 18:05:02</td>
<td>32</td>
<td>11</td>
<td>37.5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>101</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>2020-01-01 19:00:52</td>
<td>27</td>
<td>10</td>
<td>44.44</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>102</td>
<td>3</td>
<td>1</td>
<td>4</td>
<td>2020-01-02 23:51:23</td>
<td>20</td>
<td>21</td>
<td>40.2</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td>103</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>2020-01-04 13:23:46</td>
<td>40</td>
<td>29</td>
<td>35.1</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td>104</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>2020-01-08 21:00:29</td>
<td>15</td>
<td>10</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>105</td>
<td>7</td>
<td>2</td>
<td>2</td>
<td>2020-01-08 21:20:29</td>
<td>25</td>
<td>10</td>
<td>60</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>102</td>
<td>8</td>
<td>2</td>
<td>4</td>
<td>2020-01-09 23:54:33</td>
<td>15</td>
<td>20</td>
<td>93.6</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>104</td>
<td>10</td>
<td>1</td>
<td>3</td>
<td>2020-01-11 18:34:49</td>
<td>10</td>
<td>16</td>
<td>60</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="if-a-meat-lovers-pizza-was-12-and-vegetarian-10-fixed-prices-with-no-cost-for-extras-and-each-runner-is-paid-0.30-per-kilometre-traveled---how-much-money-does-pizza-runner-have-left-over-after-these-deliveries" class="level3">
<h3 class="anchored" data-anchor-id="if-a-meat-lovers-pizza-was-12-and-vegetarian-10-fixed-prices-with-no-cost-for-extras-and-each-runner-is-paid-0.30-per-kilometre-traveled---how-much-money-does-pizza-runner-have-left-over-after-these-deliveries">5. If a Meat Lovers pizza was $12 and Vegetarian $10 fixed prices with no cost for extras and each runner is paid $0.30 per kilometre traveled - how much money does Pizza Runner have left over after these deliveries?</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> PN.pizza_name <span class="op">=</span> <span class="st">'Meatlovers'</span> <span class="cf">THEN</span> <span class="dv">12</span> <span class="cf">ELSE</span> <span class="dv">10</span> <span class="cf">END</span>) <span class="kw">AS</span> Total_revenue,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>(RO.distance) <span class="op">*</span> <span class="fl">0.3</span>, <span class="dv">2</span>) <span class="kw">AS</span> runner_earned_amount,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> PN.pizza_name <span class="op">=</span> <span class="st">'Meatlovers'</span> <span class="cf">THEN</span> <span class="dv">12</span> <span class="cf">ELSE</span> <span class="dv">10</span> <span class="cf">END</span>) <span class="op">-</span> <span class="fu">ROUND</span>(<span class="fu">SUM</span>(RO.distance) <span class="op">*</span> <span class="fl">0.3</span>, <span class="dv">2</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AS</span> Profit_left_after_paying_to_runners</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> runner_orders_temp <span class="kw">AS</span> RO <span class="kw">ON</span> CO.order_id <span class="op">=</span> RO.order_id</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> pizza_names <span class="kw">AS</span> PN <span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PN.pizza_id</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> RO.distance <span class="op">!=</span> <span class="dv">0</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 29%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Total_revenue</th>
<th>runner_earned_amount</th>
<th>Profit_left_after_paying_to_runners</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>138</td>
<td>64.62</td>
<td>73.38</td>
</tr>
</tbody>
</table>
<section id="profit-analysis-for-pizza-runner-deliveries" class="level4">
<h4 class="anchored" data-anchor-id="profit-analysis-for-pizza-runner-deliveries">Profit Analysis for Pizza Runner Deliveries</h4>
<ol type="1">
<li><p><strong>Revenue Generation</strong>:</p>
<ul>
<li>The total revenue generated from delivering pizzas, considering fixed prices for Meat Lovers and Vegetarian pizzas, amounts to $138.</li>
</ul></li>
<li><p><strong>Runner Expenses</strong>:</p>
<ul>
<li>Runners are compensated at a rate of $0.30 per kilometer traveled. The total amount paid to runners for delivering pizzas is $64.62.</li>
</ul></li>
<li><p><strong>Profit Analysis</strong>:</p>
<ul>
<li>After deducting the expenses incurred for paying runners from the total revenue generated, Pizza Runner has a profit of $73.38 left over from these deliveries.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first-1" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-quantity-of-each-ingredient-used-in-all-delivered-pizzas-sorted-by-most-frequent-first-1">6. What is the total quantity of each ingredient used in all delivered pizzas sorted by most frequent first?</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> pizza_ingredients <span class="kw">AS</span> (</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> CO.order_id, CO.customer_id, PT.topping_name,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> PR.topping_id <span class="kw">IN</span> (<span class="kw">SELECT</span> extra_id <span class="kw">FROM</span> extrasBreak_ <span class="kw">AS</span> EB1 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB1.record_id) <span class="cf">THEN</span> <span class="dv">2</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> PR.topping_id <span class="kw">IN</span> (<span class="kw">SELECT</span> exclusions_id <span class="kw">FROM</span> exclusionsBreak_ <span class="kw">AS</span> EB2 <span class="kw">WHERE</span> CO.record_id <span class="op">=</span> EB2.record_id) <span class="cf">THEN</span> <span class="dv">0</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="dv">1</span> <span class="cf">END</span> <span class="kw">AS</span> ingredients_used</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customer_orders_temp <span class="kw">AS</span> CO <span class="kw">JOIN</span> pizza_recipes_temp <span class="kw">AS</span> PR</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> CO.pizza_id <span class="op">=</span> PR.pizza_id <span class="kw">JOIN</span> pizza_toppings <span class="kw">AS</span> PT</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> PT.topping_id <span class="op">=</span> PR.topping_id</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PI.topping_name, <span class="fu">SUM</span>(ingredients_used) <span class="kw">AS</span> qty_used_of_each_ingredients <span class="kw">FROM</span> pizza_ingredients <span class="kw">AS</span> PI</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PI.topping_name</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> PI.topping_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>topping_name</th>
<th>qty_used_of_each_ingredients</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bacon</td>
<td>13</td>
</tr>
<tr class="even">
<td>BBQ Sauce</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Beef</td>
<td>10</td>
</tr>
<tr class="even">
<td>Cheese</td>
<td>13</td>
</tr>
<tr class="odd">
<td>Chicken</td>
<td>10</td>
</tr>
<tr class="even">
<td>Mushrooms</td>
<td>14</td>
</tr>
<tr class="odd">
<td>Onions</td>
<td>4</td>
</tr>
<tr class="even">
<td>Pepperoni</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Peppers</td>
<td>4</td>
</tr>
<tr class="even">
<td>Salami</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Tomato Sauce</td>
<td>4</td>
</tr>
<tr class="even">
<td>Tomatoes</td>
<td>4</td>
</tr>
</tbody>
</table>
<section id="ingredient-usage-analysis-for-delivered-pizzas" class="level4">
<h4 class="anchored" data-anchor-id="ingredient-usage-analysis-for-delivered-pizzas">Ingredient Usage Analysis for Delivered Pizzas</h4>
<ol type="1">
<li><p><strong>Top Ingredients</strong>:</p>
<ul>
<li>Mushrooms: With a total quantity of 14 units, mushrooms emerge as the most commonly used ingredient in delivered pizzas.</li>
<li>Bacon and Cheese: Bacon and cheese tie for the second position, each with a total quantity of 13 units.</li>
<li>BBQ Sauce, Beef, Chicken, Pepperoni, and Salami: These ingredients have a total quantity of 10 units each, indicating their popularity among the pizza toppings.</li>
<li>Onions, Peppers, Tomato Sauce, and Tomatoes: These ingredients have a relatively lower total quantity, each appearing four times in the delivered pizzas.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="e.-bonus-questions-1" class="level2">
<h2 class="anchored" data-anchor-id="e.-bonus-questions-1">E. Bonus Questions</h2>
<section id="if-danny-wants-to-expand-his-range-of-pizzas---how-would-this-impact-the-existing-data-design-write-an-insert-statement-to-demonstrate-what-would-happen-if-a-new-supreme-pizza-with-all-the-toppings-was-added-to-the-pizza-runner-menu" class="level3">
<h3 class="anchored" data-anchor-id="if-danny-wants-to-expand-his-range-of-pizzas---how-would-this-impact-the-existing-data-design-write-an-insert-statement-to-demonstrate-what-would-happen-if-a-new-supreme-pizza-with-all-the-toppings-was-added-to-the-pizza-runner-menu">1. If Danny wants to expand his range of pizzas - how would this impact the existing data design? Write an INSERT statement to demonstrate what would happen if a new Supreme pizza with all the toppings was added to the Pizza Runner menu?</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> pizza_names (pizza_id, pizza_name)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span> (<span class="dv">3</span>, <span class="st">'Supreme'</span>);</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> pizza_recipes</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">MODIFY</span> <span class="kw">COLUMN</span> toppings <span class="dt">VARCHAR</span>(<span class="dv">50</span>);</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> pizza_recipes (pizza_id, toppings)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span> (<span class="dv">3</span>, <span class="st">'1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>pizza_id</th>
<th>toppings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1, 2, 3, 4, 5, 6, 8, 10</td>
</tr>
<tr class="even">
<td>2</td>
<td>4, 6, 7, 9, 11, 12</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12</td>
</tr>
</tbody>
</table>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>