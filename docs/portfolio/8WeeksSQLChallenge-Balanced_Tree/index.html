<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chirag Sharma">
<meta name="dcterms.date" content="2024-01-07">
<meta name="description" content="In this post, we’ll tackle the second case study using MySQL from 8weeksqlchallenge.com. We’ll Explore the Pizza Runner case study with us, delving into the data to optimize operations and unveil customer insights using SQL analytics. Join the journey where ’80s Retro Styling and Pizza is the future drive the success of this innovative pizza delivery venture!">

<title>Case Study #7 - Balanced Tree.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon/icons8-darth-vader-512.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Chirag Sharma’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html" rel="" target="">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume/chirag_sharma_resume.pdf" rel="" target="">
 <span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Chirag1994" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/chiragsharma1994/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:chirag.sharma0378@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">Case Study #7 - Balanced Tree.</h1>
                  <div>
        <div class="description">
          In this post, we’ll tackle the second case study using MySQL from 8weeksqlchallenge.com. We’ll Explore the Pizza Runner case study with us, delving into the data to optimize operations and unveil customer insights using SQL analytics. Join the journey where ’80s Retro Styling and Pizza is the future drive the success of this innovative pizza delivery venture!
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">MySQL</div>
                <div class="quarto-category">SQL</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://chirag1994.github.io/">Chirag Sharma</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 7, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">




<section id="case-study-7---balanced-tree" class="level1">
<h1>Case Study #7 - Balanced Tree</h1>
<p><img src="./Images/Case_Study_7-Balanced_Tree.png" alt="Image1" width="800" height="800"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Balanced Tree Clothing Company prides themselves on providing an optimised range of clothing and lifestyle wear for the modern adventurer!</p>
<p>Danny, the CEO of this trendy fashion company has asked you to assist the team’s merchandising teams analyse their sales performance and generate a basic financial report to share with the wider business.</p>
<hr>
</section>
<section id="available-data" class="level2">
<h2 class="anchored" data-anchor-id="available-data">Available Data</h2>
<p>For this case study there is a total of 4 datasets - however you will only need to utilise 2 main tables to solve all of the regular questions, and the additional 2 tables are used only for the bonus challenge question!</p>
<section id="product-details" class="level3">
<h3 class="anchored" data-anchor-id="product-details">Product Details</h3>
<p><code>balanced_tree.product_details</code> includes all information about the entire range that Balanced Clothing sells in their store.</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>product_id</th>
<th>price</th>
<th>product_name</th>
<th>category_id</th>
<th>segment_id</th>
<th>style_id</th>
<th>category_name</th>
<th>segment_name</th>
<th>style_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>c4a632</td>
<td>13</td>
<td>Navy Oversized Jeans - Womens</td>
<td>1</td>
<td>3</td>
<td>7</td>
<td>Womens</td>
<td>Jeans</td>
<td>Navy Oversized</td>
</tr>
<tr class="even">
<td>e83aa3</td>
<td>32</td>
<td>Black Straight Jeans - Womens</td>
<td>1</td>
<td>3</td>
<td>8</td>
<td>Womens</td>
<td>Jeans</td>
<td>Black Straight</td>
</tr>
<tr class="odd">
<td>e31d39</td>
<td>10</td>
<td>Cream Relaxed Jeans - Womens</td>
<td>1</td>
<td>3</td>
<td>9</td>
<td>Womens</td>
<td>Jeans</td>
<td>Cream Relaxed</td>
</tr>
<tr class="even">
<td>d5e9a6</td>
<td>23</td>
<td>Khaki Suit Jacket - Womens</td>
<td>1</td>
<td>4</td>
<td>10</td>
<td>Womens</td>
<td>Jacket</td>
<td>Khaki Suit</td>
</tr>
<tr class="odd">
<td>72f5d4</td>
<td>19</td>
<td>Indigo Rain Jacket - Womens</td>
<td>1</td>
<td>4</td>
<td>11</td>
<td>Womens</td>
<td>Jacket</td>
<td>Indigo Rain</td>
</tr>
<tr class="even">
<td>9ec847</td>
<td>54</td>
<td>Grey Fashion Jacket - Womens</td>
<td>1</td>
<td>4</td>
<td>12</td>
<td>Womens</td>
<td>Jacket</td>
<td>Grey Fashion</td>
</tr>
<tr class="odd">
<td>5d267b</td>
<td>40</td>
<td>White Tee Shirt - Mens</td>
<td>2</td>
<td>5</td>
<td>13</td>
<td>Mens</td>
<td>Shirt</td>
<td>White Tee</td>
</tr>
<tr class="even">
<td>c8d436</td>
<td>10</td>
<td>Teal Button Up Shirt - Mens</td>
<td>2</td>
<td>5</td>
<td>14</td>
<td>Mens</td>
<td>Shirt</td>
<td>Teal Button Up</td>
</tr>
<tr class="odd">
<td>2a2353</td>
<td>57</td>
<td>Blue Polo Shirt - Mens</td>
<td>2</td>
<td>5</td>
<td>15</td>
<td>Mens</td>
<td>Shirt</td>
<td>Blue Polo</td>
</tr>
<tr class="even">
<td>f084eb</td>
<td>36</td>
<td>Navy Solid Socks - Mens</td>
<td>2</td>
<td>6</td>
<td>16</td>
<td>Mens</td>
<td>Socks</td>
<td>Navy Solid</td>
</tr>
<tr class="odd">
<td>b9a74d</td>
<td>17</td>
<td>White Striped Socks - Mens</td>
<td>2</td>
<td>6</td>
<td>17</td>
<td>Mens</td>
<td>Socks</td>
<td>White Striped</td>
</tr>
<tr class="even">
<td>2feb6b</td>
<td>29</td>
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>2</td>
<td>6</td>
<td>18</td>
<td>Mens</td>
<td>Socks</td>
<td>Pink Fluro Polkadot</td>
</tr>
</tbody>
</table>
</section>
<section id="product-sales" class="level3">
<h3 class="anchored" data-anchor-id="product-sales">Product Sales</h3>
<p><code>balanced_tree.sales</code> contains product level information for all the transactions made for Balanced Tree including quantity, price, percentage discount, member status, a transaction ID and also the transaction timestamp.</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>prod_id</th>
<th>qty</th>
<th>price</th>
<th>discount</th>
<th>member</th>
<th>txn_id</th>
<th>start_txn_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>c4a632</td>
<td>4</td>
<td>13</td>
<td>17</td>
<td>t</td>
<td>54f307</td>
<td>2021-02-13 01:59:43.296</td>
</tr>
<tr class="even">
<td>5d267b</td>
<td>4</td>
<td>40</td>
<td>17</td>
<td>t</td>
<td>54f307</td>
<td>2021-02-13 01:59:43.296</td>
</tr>
<tr class="odd">
<td>b9a74d</td>
<td>4</td>
<td>17</td>
<td>17</td>
<td>t</td>
<td>54f307</td>
<td>2021-02-13 01:59:43.296</td>
</tr>
<tr class="even">
<td>2feb6b</td>
<td>2</td>
<td>29</td>
<td>17</td>
<td>t</td>
<td>54f307</td>
<td>2021-02-13 01:59:43.296</td>
</tr>
<tr class="odd">
<td>c4a632</td>
<td>5</td>
<td>13</td>
<td>21</td>
<td>t</td>
<td>26cc98</td>
<td>2021-01-19 01:39:00.3456</td>
</tr>
<tr class="even">
<td>e31d39</td>
<td>2</td>
<td>10</td>
<td>21</td>
<td>t</td>
<td>26cc98</td>
<td>2021-01-19 01:39:00.3456</td>
</tr>
<tr class="odd">
<td>72f5d4</td>
<td>3</td>
<td>19</td>
<td>21</td>
<td>t</td>
<td>26cc98</td>
<td>2021-01-19 01:39:00.3456</td>
</tr>
<tr class="even">
<td>2a2353</td>
<td>3</td>
<td>57</td>
<td>21</td>
<td>t</td>
<td>26cc98</td>
<td>2021-01-19 01:39:00.3456</td>
</tr>
<tr class="odd">
<td>f084eb</td>
<td>3</td>
<td>36</td>
<td>21</td>
<td>t</td>
<td>26cc98</td>
<td>2021-01-19 01:39:00.3456</td>
</tr>
<tr class="even">
<td>c4a632</td>
<td>1</td>
<td>13</td>
<td>21</td>
<td>f</td>
<td>ef648d</td>
<td>2021-01-27 02:18:17.1648</td>
</tr>
</tbody>
</table>
</section>
<section id="product-hierarcy-product-price" class="level3">
<h3 class="anchored" data-anchor-id="product-hierarcy-product-price">Product Hierarcy &amp; Product Price</h3>
<p>Thes tables are used only for the bonus question where we will use them to recreate the <code>balanced_tree.product_details</code> table.</p>
<p><code>balanced_tree.product_hierarchy</code></p>
<table class="table">
<thead>
<tr class="header">
<th>id</th>
<th>parent_id</th>
<th>level_text</th>
<th>level_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td></td>
<td>Womens</td>
<td>Category</td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
<td>Mens</td>
<td>Category</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>Jeans</td>
<td>Segment</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td>Jacket</td>
<td>Segment</td>
</tr>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>Shirt</td>
<td>Segment</td>
</tr>
<tr class="even">
<td>6</td>
<td>2</td>
<td>Socks</td>
<td>Segment</td>
</tr>
<tr class="odd">
<td>7</td>
<td>3</td>
<td>Navy Oversized</td>
<td>Style</td>
</tr>
<tr class="even">
<td>8</td>
<td>3</td>
<td>Black Straight</td>
<td>Style</td>
</tr>
<tr class="odd">
<td>9</td>
<td>3</td>
<td>Cream Relaxed</td>
<td>Style</td>
</tr>
<tr class="even">
<td>10</td>
<td>4</td>
<td>Khaki Suit</td>
<td>Style</td>
</tr>
<tr class="odd">
<td>11</td>
<td>4</td>
<td>Indigo Rain</td>
<td>Style</td>
</tr>
<tr class="even">
<td>12</td>
<td>4</td>
<td>Grey Fashion</td>
<td>Style</td>
</tr>
<tr class="odd">
<td>13</td>
<td>5</td>
<td>White Tee</td>
<td>Style</td>
</tr>
<tr class="even">
<td>14</td>
<td>5</td>
<td>Teal Button Up</td>
<td>Style</td>
</tr>
<tr class="odd">
<td>15</td>
<td>5</td>
<td>Blue Polo</td>
<td>Style</td>
</tr>
<tr class="even">
<td>16</td>
<td>6</td>
<td>Navy Solid</td>
<td>Style</td>
</tr>
<tr class="odd">
<td>17</td>
<td>6</td>
<td>White Striped</td>
<td>Style</td>
</tr>
<tr class="even">
<td>18</td>
<td>6</td>
<td>Pink Fluro Polkadot</td>
<td>Style</td>
</tr>
</tbody>
</table>
<p><code>balanced_tree.product_prices</code></p>
<table class="table">
<thead>
<tr class="header">
<th>id</th>
<th>product_id</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>c4a632</td>
<td>13</td>
</tr>
<tr class="even">
<td>8</td>
<td>e83aa3</td>
<td>32</td>
</tr>
<tr class="odd">
<td>9</td>
<td>e31d39</td>
<td>10</td>
</tr>
<tr class="even">
<td>10</td>
<td>d5e9a6</td>
<td>23</td>
</tr>
<tr class="odd">
<td>11</td>
<td>72f5d4</td>
<td>19</td>
</tr>
<tr class="even">
<td>12</td>
<td>9ec847</td>
<td>54</td>
</tr>
<tr class="odd">
<td>13</td>
<td>5d267b</td>
<td>40</td>
</tr>
<tr class="even">
<td>14</td>
<td>c8d436</td>
<td>10</td>
</tr>
<tr class="odd">
<td>15</td>
<td>2a2353</td>
<td>57</td>
</tr>
<tr class="even">
<td>16</td>
<td>f084eb</td>
<td>36</td>
</tr>
<tr class="odd">
<td>17</td>
<td>b9a74d</td>
<td>17</td>
</tr>
<tr class="even">
<td>18</td>
<td>2feb6b</td>
<td>29</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="interactive-sql-session" class="level2">
<h2 class="anchored" data-anchor-id="interactive-sql-session">Interactive SQL Session</h2>
<p>The Dataset for this case study can be accessed from <a href="https://www.db-fiddle.com/f/dkhULDEjGib3K58MvDjYJr/8">here</a>. I will be using MySQL to solve this case study. In order to solve yourself this case study, simply go to the above link and choose MySQL Dialect (version &gt; 8, if using MySQL version higher than 8 locally), copy &amp; paste the Database schema into MySQL.</p>
<p>Here is the snapshot of it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">SCHEMA</span> balanced_tree;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> balanced_tree.product_hierarchy (</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  `id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  `parent_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  `level_text` <span class="dt">VARCHAR</span>(<span class="dv">19</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  `level_name` <span class="dt">VARCHAR</span>(<span class="dv">8</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> balanced_tree.product_hierarchy</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  (`id`, `parent_id`, `level_text`, `level_name`)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'1'</span>, <span class="kw">NULL</span>, <span class="st">'Womens'</span>, <span class="st">'Category'</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2'</span>, <span class="kw">NULL</span>, <span class="st">'Mens'</span>, <span class="st">'Category'</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'3'</span>, <span class="st">'1'</span>, <span class="st">'Jeans'</span>, <span class="st">'Segment'</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'4'</span>, <span class="st">'1'</span>, <span class="st">'Jacket'</span>, <span class="st">'Segment'</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5'</span>, <span class="st">'2'</span>, <span class="st">'Shirt'</span>, <span class="st">'Segment'</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'6'</span>, <span class="st">'2'</span>, <span class="st">'Socks'</span>, <span class="st">'Segment'</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'7'</span>, <span class="st">'3'</span>, <span class="st">'Navy Oversized'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'8'</span>, <span class="st">'3'</span>, <span class="st">'Black Straight'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9'</span>, <span class="st">'3'</span>, <span class="st">'Cream Relaxed'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'10'</span>, <span class="st">'4'</span>, <span class="st">'Khaki Suit'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'11'</span>, <span class="st">'4'</span>, <span class="st">'Indigo Rain'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'12'</span>, <span class="st">'4'</span>, <span class="st">'Grey Fashion'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'13'</span>, <span class="st">'5'</span>, <span class="st">'White Tee'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'14'</span>, <span class="st">'5'</span>, <span class="st">'Teal Button Up'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'15'</span>, <span class="st">'5'</span>, <span class="st">'Blue Polo'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'16'</span>, <span class="st">'6'</span>, <span class="st">'Navy Solid'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'17'</span>, <span class="st">'6'</span>, <span class="st">'White Striped'</span>, <span class="st">'Style'</span>),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'18'</span>, <span class="st">'6'</span>, <span class="st">'Pink Fluro Polkadot'</span>, <span class="st">'Style'</span>);</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> balanced_tree.product_prices (</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  `id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  `product_id` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  `price` <span class="dt">INTEGER</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> balanced_tree.product_prices</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  (`id`, `product_id`, `price`)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'7'</span>, <span class="st">'c4a632'</span>, <span class="st">'13'</span>),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'8'</span>, <span class="st">'e83aa3'</span>, <span class="st">'32'</span>),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9'</span>, <span class="st">'e31d39'</span>, <span class="st">'10'</span>),</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'10'</span>, <span class="st">'d5e9a6'</span>, <span class="st">'23'</span>),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'11'</span>, <span class="st">'72f5d4'</span>, <span class="st">'19'</span>),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'12'</span>, <span class="st">'9ec847'</span>, <span class="st">'54'</span>),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'13'</span>, <span class="st">'5d267b'</span>, <span class="st">'40'</span>),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'14'</span>, <span class="st">'c8d436'</span>, <span class="st">'10'</span>),</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'15'</span>, <span class="st">'2a2353'</span>, <span class="st">'57'</span>),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'16'</span>, <span class="st">'f084eb'</span>, <span class="st">'36'</span>),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'17'</span>, <span class="st">'b9a74d'</span>, <span class="st">'17'</span>),</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'18'</span>, <span class="st">'2feb6b'</span>, <span class="st">'29'</span>);</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> balanced_tree.product_details (</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  `product_id` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  `price` <span class="dt">INTEGER</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  `product_name` <span class="dt">VARCHAR</span>(<span class="dv">32</span>),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  `category_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  `segment_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  `style_id` <span class="dt">INTEGER</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  `category_name` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  `segment_name` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  `style_name` <span class="dt">VARCHAR</span>(<span class="dv">19</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> balanced_tree.product_details</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  (`product_id`, `price`, `product_name`, `category_id`, `segment_id`, `style_id`, `category_name`, </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>   `segment_name`, `style_name`)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'13'</span>, <span class="st">'Navy Oversized Jeans - Womens'</span>, <span class="st">'1'</span>, <span class="st">'3'</span>, <span class="st">'7'</span>, <span class="st">'Womens'</span>, <span class="st">'Jeans'</span>, <span class="st">'Navy Oversized'</span>),</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e83aa3'</span>, <span class="st">'32'</span>, <span class="st">'Black Straight Jeans - Womens'</span>, <span class="st">'1'</span>, <span class="st">'3'</span>, <span class="st">'8'</span>, <span class="st">'Womens'</span>, <span class="st">'Jeans'</span>, <span class="st">'Black Straight'</span>),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e31d39'</span>, <span class="st">'10'</span>, <span class="st">'Cream Relaxed Jeans - Womens'</span>, <span class="st">'1'</span>, <span class="st">'3'</span>, <span class="st">'9'</span>, <span class="st">'Womens'</span>, <span class="st">'Jeans'</span>, <span class="st">'Cream Relaxed'</span>),</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'d5e9a6'</span>, <span class="st">'23'</span>, <span class="st">'Khaki Suit Jacket - Womens'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">'10'</span>, <span class="st">'Womens'</span>, <span class="st">'Jacket'</span>, <span class="st">'Khaki Suit'</span>),</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'72f5d4'</span>, <span class="st">'19'</span>, <span class="st">'Indigo Rain Jacket - Womens'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">'11'</span>, <span class="st">'Womens'</span>, <span class="st">'Jacket'</span>, <span class="st">'Indigo Rain'</span>),</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9ec847'</span>, <span class="st">'54'</span>, <span class="st">'Grey Fashion Jacket - Womens'</span>, <span class="st">'1'</span>, <span class="st">'4'</span>, <span class="st">'12'</span>, <span class="st">'Womens'</span>, <span class="st">'Jacket'</span>, <span class="st">'Grey Fashion'</span>),</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5d267b'</span>, <span class="st">'40'</span>, <span class="st">'White Tee Shirt - Mens'</span>, <span class="st">'2'</span>, <span class="st">'5'</span>, <span class="st">'13'</span>, <span class="st">'Mens'</span>, <span class="st">'Shirt'</span>, <span class="st">'White Tee'</span>),</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c8d436'</span>, <span class="st">'10'</span>, <span class="st">'Teal Button Up Shirt - Mens'</span>, <span class="st">'2'</span>, <span class="st">'5'</span>, <span class="st">'14'</span>, <span class="st">'Mens'</span>, <span class="st">'Shirt'</span>, <span class="st">'Teal Button Up'</span>),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2a2353'</span>, <span class="st">'57'</span>, <span class="st">'Blue Polo Shirt - Mens'</span>, <span class="st">'2'</span>, <span class="st">'5'</span>, <span class="st">'15'</span>, <span class="st">'Mens'</span>, <span class="st">'Shirt'</span>, <span class="st">'Blue Polo'</span>),</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'36'</span>, <span class="st">'Navy Solid Socks - Mens'</span>, <span class="st">'2'</span>, <span class="st">'6'</span>, <span class="st">'16'</span>, <span class="st">'Mens'</span>, <span class="st">'Socks'</span>, <span class="st">'Navy Solid'</span>),</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'b9a74d'</span>, <span class="st">'17'</span>, <span class="st">'White Striped Socks - Mens'</span>, <span class="st">'2'</span>, <span class="st">'6'</span>, <span class="st">'17'</span>, <span class="st">'Mens'</span>, <span class="st">'Socks'</span>, <span class="st">'White Striped'</span>),</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2feb6b'</span>, <span class="st">'29'</span>, <span class="st">'Pink Fluro Polkadot Socks - Mens'</span>, <span class="st">'2'</span>, <span class="st">'6'</span>, <span class="st">'18'</span>, <span class="st">'Mens'</span>, <span class="st">'Socks'</span>, <span class="st">'Pink Fluro Polkadot'</span>);</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> balanced_tree.sales (</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  `prod_id` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  `qty` <span class="dt">INTEGER</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  `price` <span class="dt">INTEGER</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  `discount` <span class="dt">INTEGER</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  `member` <span class="dt">VARCHAR</span>(<span class="dv">2</span>),</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  `txn_id` <span class="dt">VARCHAR</span>(<span class="dv">6</span>),</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  `start_txn_time` <span class="dt">TIMESTAMP</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> balanced_tree.sales</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  (`prod_id`, `qty`, `price`, `discount`, `member`, `txn_id`, `start_txn_time`)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="kw">VALUES</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'4'</span>, <span class="st">'13'</span>, <span class="st">'17'</span>, <span class="st">'t'</span>, <span class="st">'54f307'</span>, <span class="st">'2021-02-13 01:59:43.296'</span>),</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5d267b'</span>, <span class="st">'4'</span>, <span class="st">'40'</span>, <span class="st">'17'</span>, <span class="st">'t'</span>, <span class="st">'54f307'</span>, <span class="st">'2021-02-13 01:59:43.296'</span>),</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'b9a74d'</span>, <span class="st">'4'</span>, <span class="st">'17'</span>, <span class="st">'17'</span>, <span class="st">'t'</span>, <span class="st">'54f307'</span>, <span class="st">'2021-02-13 01:59:43.296'</span>),</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2feb6b'</span>, <span class="st">'2'</span>, <span class="st">'29'</span>, <span class="st">'17'</span>, <span class="st">'t'</span>, <span class="st">'54f307'</span>, <span class="st">'2021-02-13 01:59:43.296'</span>),</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'5'</span>, <span class="st">'13'</span>, <span class="st">'21'</span>, <span class="st">'t'</span>, <span class="st">'26cc98'</span>, <span class="st">'2021-01-19 01:39:00.3456'</span>),</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e31d39'</span>, <span class="st">'2'</span>, <span class="st">'10'</span>, <span class="st">'21'</span>, <span class="st">'t'</span>, <span class="st">'26cc98'</span>, <span class="st">'2021-01-19 01:39:00.3456'</span>),</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'72f5d4'</span>, <span class="st">'3'</span>, <span class="st">'19'</span>, <span class="st">'21'</span>, <span class="st">'t'</span>, <span class="st">'26cc98'</span>, <span class="st">'2021-01-19 01:39:00.3456'</span>),</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2a2353'</span>, <span class="st">'3'</span>, <span class="st">'57'</span>, <span class="st">'21'</span>, <span class="st">'t'</span>, <span class="st">'26cc98'</span>, <span class="st">'2021-01-19 01:39:00.3456'</span>),</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'3'</span>, <span class="st">'36'</span>, <span class="st">'21'</span>, <span class="st">'t'</span>, <span class="st">'26cc98'</span>, <span class="st">'2021-01-19 01:39:00.3456'</span>),</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'1'</span>, <span class="st">'13'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e83aa3'</span>, <span class="st">'5'</span>, <span class="st">'32'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'d5e9a6'</span>, <span class="st">'1'</span>, <span class="st">'23'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'72f5d4'</span>, <span class="st">'1'</span>, <span class="st">'19'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'5d267b'</span>, <span class="st">'3'</span>, <span class="st">'40'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'4'</span>, <span class="st">'36'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'b9a74d'</span>, <span class="st">'4'</span>, <span class="st">'17'</span>, <span class="st">'21'</span>, <span class="st">'f'</span>, <span class="st">'ef648d'</span>, <span class="st">'2021-01-27 02:18:17.1648'</span>),</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'2'</span>, <span class="st">'13'</span>, <span class="st">'23'</span>, <span class="st">'t'</span>, <span class="st">'fba96f'</span>, <span class="st">'2021-03-03 00:32:56.0544'</span>),</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e31d39'</span>, <span class="st">'5'</span>, <span class="st">'10'</span>, <span class="st">'23'</span>, <span class="st">'t'</span>, <span class="st">'fba96f'</span>, <span class="st">'2021-03-03 00:32:56.0544'</span>),</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9ec847'</span>, <span class="st">'3'</span>, <span class="st">'54'</span>, <span class="st">'23'</span>, <span class="st">'t'</span>, <span class="st">'fba96f'</span>, <span class="st">'2021-03-03 00:32:56.0544'</span>),</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'4'</span>, <span class="st">'36'</span>, <span class="st">'23'</span>, <span class="st">'t'</span>, <span class="st">'fba96f'</span>, <span class="st">'2021-03-03 00:32:56.0544'</span>),</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2feb6b'</span>, <span class="st">'2'</span>, <span class="st">'29'</span>, <span class="st">'23'</span>, <span class="st">'t'</span>, <span class="st">'fba96f'</span>, <span class="st">'2021-03-03 00:32:56.0544'</span>),</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'5'</span>, <span class="st">'13'</span>, <span class="st">'11'</span>, <span class="st">'t'</span>, <span class="st">'4e9268'</span>, <span class="st">'2021-01-23 14:18:54.0576'</span>),</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e31d39'</span>, <span class="st">'4'</span>, <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'t'</span>, <span class="st">'4e9268'</span>, <span class="st">'2021-01-23 14:18:54.0576'</span>),</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'72f5d4'</span>, <span class="st">'5'</span>, <span class="st">'19'</span>, <span class="st">'11'</span>, <span class="st">'t'</span>, <span class="st">'4e9268'</span>, <span class="st">'2021-01-23 14:18:54.0576'</span>),</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'2'</span>, <span class="st">'36'</span>, <span class="st">'11'</span>, <span class="st">'t'</span>, <span class="st">'4e9268'</span>, <span class="st">'2021-01-23 14:18:54.0576'</span>),</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'b9a74d'</span>, <span class="st">'2'</span>, <span class="st">'17'</span>, <span class="st">'11'</span>, <span class="st">'t'</span>, <span class="st">'4e9268'</span>, <span class="st">'2021-01-23 14:18:54.0576'</span>),</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e83aa3'</span>, <span class="st">'4'</span>, <span class="st">'32'</span>, <span class="st">'4'</span>, <span class="st">'t'</span>, <span class="st">'9717d4'</span>, <span class="st">'2021-01-29 07:22:13.2672'</span>),</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'d5e9a6'</span>, <span class="st">'2'</span>, <span class="st">'23'</span>, <span class="st">'4'</span>, <span class="st">'t'</span>, <span class="st">'9717d4'</span>, <span class="st">'2021-01-29 07:22:13.2672'</span>),</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c8d436'</span>, <span class="st">'4'</span>, <span class="st">'10'</span>, <span class="st">'4'</span>, <span class="st">'t'</span>, <span class="st">'9717d4'</span>, <span class="st">'2021-01-29 07:22:13.2672'</span>),</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2a2353'</span>, <span class="st">'1'</span>, <span class="st">'57'</span>, <span class="st">'4'</span>, <span class="st">'t'</span>, <span class="st">'9717d4'</span>, <span class="st">'2021-01-29 07:22:13.2672'</span>),</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'1'</span>, <span class="st">'36'</span>, <span class="st">'4'</span>, <span class="st">'t'</span>, <span class="st">'9717d4'</span>, <span class="st">'2021-01-29 07:22:13.2672'</span>),</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'72f5d4'</span>, <span class="st">'3'</span>, <span class="st">'19'</span>, <span class="st">'14'</span>, <span class="st">'f'</span>, <span class="st">'e9a1dd'</span>, <span class="st">'2021-03-28 20:01:43.1328'</span>),</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'9ec847'</span>, <span class="st">'3'</span>, <span class="st">'54'</span>, <span class="st">'14'</span>, <span class="st">'f'</span>, <span class="st">'e9a1dd'</span>, <span class="st">'2021-03-28 20:01:43.1328'</span>),</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'2a2353'</span>, <span class="st">'4'</span>, <span class="st">'57'</span>, <span class="st">'14'</span>, <span class="st">'f'</span>, <span class="st">'e9a1dd'</span>, <span class="st">'2021-03-28 20:01:43.1328'</span>),</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'f084eb'</span>, <span class="st">'2'</span>, <span class="st">'36'</span>, <span class="st">'14'</span>, <span class="st">'f'</span>, <span class="st">'e9a1dd'</span>, <span class="st">'2021-03-28 20:01:43.1328'</span>),</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'c4a632'</span>, <span class="st">'3'</span>, <span class="st">'13'</span>, <span class="st">'6'</span>, <span class="st">'f'</span>, <span class="st">'003ea6'</span>, <span class="st">'2021-01-20 14:21:00.9792'</span>),</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'e31d39'</span>, <span class="st">'3'</span>, <span class="st">'10'</span>, <span class="st">'6'</span>, <span class="st">'f'</span>, <span class="st">'003ea6'</span>, <span class="st">'2021-01-20 14:21:00.9792'</span>),</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  (<span class="st">'d5e9a6'</span>, <span class="st">'3'</span>, <span class="st">'23'</span>, <span class="st">'6'</span>, <span class="st">'f'</span>, <span class="st">'003ea6'</span>, <span class="st">'2021-01-20 14:21:00.9792'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="case-study-questions" class="level2">
<h2 class="anchored" data-anchor-id="case-study-questions">Case Study Questions</h2>
<p>The following questions can be considered key business questions and metrics that the Balanced Tree team requires for their monthly reports.</p>
<p>Each question can be answered using a single query - but as you are writing the SQL to solve each individual problem, keep in mind how you would generate all of these metrics in a single SQL script which the Balanced Tree team can run each month.</p>
<section id="a.-high-level-sales-analysis" class="level3">
<h3 class="anchored" data-anchor-id="a.-high-level-sales-analysis">A. High Level Sales Analysis</h3>
<ol type="1">
<li>What was the total quantity sold for all products?</li>
<li>What is the total generated revenue for all products before discounts?</li>
<li>What was the total discount amount for all products?</li>
</ol>
</section>
<section id="b.-transaction-analysis" class="level3">
<h3 class="anchored" data-anchor-id="b.-transaction-analysis">B. Transaction Analysis</h3>
<ol type="1">
<li>How many unique transactions were there?</li>
<li>What is the average unique products purchased in each transaction?</li>
<li>What are the 25th, 50th and 75th percentile values for the revenue per transaction?</li>
<li>What is the average discount value per transaction?</li>
<li>What is the percentage split of all transactions for members vs non-members?</li>
<li>What is the average revenue for member transactions and non-member transactions?</li>
</ol>
</section>
<section id="c.-product-analysis" class="level3">
<h3 class="anchored" data-anchor-id="c.-product-analysis">C. Product Analysis</h3>
<ol type="1">
<li>What are the top 3 products by total revenue before discount?</li>
<li>What is the total quantity, revenue and discount for each segment?</li>
<li>What is the top selling product for each segment?</li>
<li>What is the total quantity, revenue and discount for each category?</li>
<li>What is the top selling product for each category?</li>
<li>What is the percentage split of revenue by product for each segment?</li>
<li>What is the percentage split of revenue by segment for each category?</li>
<li>What is the percentage split of total revenue by category?</li>
<li>What is the total transaction “penetration” for each product? (hint: penetration = number of transactions where at least 1 quantity of a product was purchased divided by total number of transactions)</li>
<li>What is the most common combination of at least 1 quantity of any 3 products in a 1 single transaction?</li>
</ol>
</section>
<section id="d.-reporting-challenge" class="level3">
<h3 class="anchored" data-anchor-id="d.-reporting-challenge">D. Reporting Challenge</h3>
<p>Write a single SQL script that combines all of the previous questions into a scheduled report that the Balanced Tree team can run at the beginning of each month to calculate the previous month’s values.</p>
<p>Imagine that the Chief Financial Officer (which is also Danny) has asked for all of these questions at the end of every month.</p>
<p>He first wants you to generate the data for January only - but then he also wants you to demonstrate that you can easily run the samne analysis for February without many changes (if at all).</p>
<p>Feel free to split up your final outputs into as many tables as you need - but be sure to explicitly reference which table outputs relate to which question for full marks :)</p>
</section>
<section id="e.-bonus-challenge" class="level3">
<h3 class="anchored" data-anchor-id="e.-bonus-challenge">E. Bonus Challenge</h3>
<p>Use a single SQL query to transform the product_hierarchy and product_prices datasets to the product_details table.</p>
<p>Hint: you may want to consider using a recursive CTE to solve this problem!</p>
</section>
</section>
<section id="a.-high-level-sales-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="a.-high-level-sales-analysis-1">A. High Level Sales Analysis</h2>
<section id="what-was-the-total-quantity-sold-for-all-products" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-total-quantity-sold-for-all-products">1. What was the total quantity sold for all products?</h3>
<p>Total quantity sold from all the products is given by the following query:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(qty) <span class="kw">AS</span> total_quantity_sold</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>total_quantity_sold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>45216</td>
</tr>
</tbody>
</table>
<p>Total quantity sold for all the products is given by the following query:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    PD.product_name, <span class="fu">SUM</span>(S.qty) <span class="kw">AS</span> total_quantity_sold</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.product_name</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_quantity_sold <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>product_name</th>
<th>total_quantity_sold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grey Fashion Jacket - Womens</td>
<td>3876</td>
</tr>
<tr class="even">
<td>Navy Oversized Jeans - Womens</td>
<td>3856</td>
</tr>
<tr class="odd">
<td>Blue Polo Shirt - Mens</td>
<td>3819</td>
</tr>
<tr class="even">
<td>White Tee Shirt - Mens</td>
<td>3800</td>
</tr>
<tr class="odd">
<td>Navy Solid Socks - Mens</td>
<td>3792</td>
</tr>
<tr class="even">
<td>Black Straight Jeans - Womens</td>
<td>3786</td>
</tr>
<tr class="odd">
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>3770</td>
</tr>
<tr class="even">
<td>Indigo Rain Jacket - Womens</td>
<td>3757</td>
</tr>
<tr class="odd">
<td>Khaki Suit Jacket - Womens</td>
<td>3752</td>
</tr>
<tr class="even">
<td>Cream Relaxed Jeans - Womens</td>
<td>3707</td>
</tr>
<tr class="odd">
<td>White Striped Socks - Mens</td>
<td>3655</td>
</tr>
<tr class="even">
<td>Teal Button Up Shirt - Mens</td>
<td>3646</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-quantity-sold-for-all-products" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-quantity-sold-for-all-products">Analysis of Total Quantity Sold for All Products</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The total quantity sold for all products is 45216 with the Grey Fashion Jacket and Navy Oversized Jeans being the top-selling items.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-total-generated-revenue-for-all-products-before-discounts" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-generated-revenue-for-all-products-before-discounts">2. What is the total generated revenue for all products before discounts?</h3>
<p>Total revenue before discounts</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(qty <span class="op">*</span> price) <span class="kw">AS</span> total_revenue</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>total_revenue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1289453</td>
</tr>
</tbody>
</table>
<p>Total revenue before discounts for all the products</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    PD.product_name, <span class="fu">SUM</span>(S.qty <span class="op">*</span> S.price) <span class="kw">AS</span> total_revenue</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.product_name</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_revenue <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>product_name</th>
<th>total_revenue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blue Polo Shirt - Mens</td>
<td>217683</td>
</tr>
<tr class="even">
<td>Grey Fashion Jacket - Womens</td>
<td>209304</td>
</tr>
<tr class="odd">
<td>White Tee Shirt - Mens</td>
<td>152000</td>
</tr>
<tr class="even">
<td>Navy Solid Socks - Mens</td>
<td>136512</td>
</tr>
<tr class="odd">
<td>Black Straight Jeans - Womens</td>
<td>121152</td>
</tr>
<tr class="even">
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>109330</td>
</tr>
<tr class="odd">
<td>Khaki Suit Jacket - Womens</td>
<td>86296</td>
</tr>
<tr class="even">
<td>Indigo Rain Jacket - Womens</td>
<td>71383</td>
</tr>
<tr class="odd">
<td>White Striped Socks - Mens</td>
<td>62135</td>
</tr>
<tr class="even">
<td>Navy Oversized Jeans - Womens</td>
<td>50128</td>
</tr>
<tr class="odd">
<td>Cream Relaxed Jeans - Womens</td>
<td>37070</td>
</tr>
<tr class="even">
<td>Teal Button Up Shirt - Mens</td>
<td>36460</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-revenue-before-discounts" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-revenue-before-discounts">Analysis of Total Revenue Before Discounts</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The total revenue generated for all products before discounts is $1,289,453.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-was-the-total-discount-amount-for-all-products" class="level3">
<h3 class="anchored" data-anchor-id="what-was-the-total-discount-amount-for-all-products">3. What was the total discount amount for all products?</h3>
<p>Total discount given is given by</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>((qty<span class="op">*</span>price<span class="op">*</span>discount)<span class="op">/</span><span class="dv">100</span>),<span class="dv">2</span>) <span class="kw">AS</span> total_discount</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>total_discount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>156229.14</td>
</tr>
</tbody>
</table>
<p>Total discount for all the products is given by</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    PD.product_name, <span class="fu">ROUND</span>(<span class="fu">SUM</span>((S.qty<span class="op">*</span>S.price<span class="op">*</span>S.discount)<span class="op">/</span><span class="dv">100</span>),<span class="dv">2</span>) <span class="kw">AS</span> total_discount</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.product_name</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_discount <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>product_name</th>
<th>total_discount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blue Polo Shirt - Mens</td>
<td>26819.07</td>
</tr>
<tr class="even">
<td>Grey Fashion Jacket - Womens</td>
<td>25391.88</td>
</tr>
<tr class="odd">
<td>White Tee Shirt - Mens</td>
<td>18377.60</td>
</tr>
<tr class="even">
<td>Navy Solid Socks - Mens</td>
<td>16650.36</td>
</tr>
<tr class="odd">
<td>Black Straight Jeans - Womens</td>
<td>14744.96</td>
</tr>
<tr class="even">
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>12952.27</td>
</tr>
<tr class="odd">
<td>Khaki Suit Jacket - Womens</td>
<td>10243.05</td>
</tr>
<tr class="even">
<td>Indigo Rain Jacket - Womens</td>
<td>8642.53</td>
</tr>
<tr class="odd">
<td>White Striped Socks - Mens</td>
<td>7410.81</td>
</tr>
<tr class="even">
<td>Navy Oversized Jeans - Womens</td>
<td>6135.61</td>
</tr>
<tr class="odd">
<td>Cream Relaxed Jeans - Womens</td>
<td>4463.40</td>
</tr>
<tr class="even">
<td>Teal Button Up Shirt - Mens</td>
<td>4397.60</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-discount-amount" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-discount-amount">Analysis of Total Discount Amount</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The total discount amount given across all products is $156,229.14.</li>
</ul></li>
</ol>
</section>
</section>
<section id="how-many-unique-transactions-were-there" class="level3">
<h3 class="anchored" data-anchor-id="how-many-unique-transactions-were-there">1. How many unique transactions were there?</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> txn_id) <span class="kw">AS</span> unique_number_of_transactions</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>unique_number_of_transactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2500</td>
</tr>
</tbody>
</table>
<section id="analysis-of-unique-transactions" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-unique-transactions">Analysis of Unique Transactions</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The total number of unique transactions recorded is 2,500. Each transaction represents a distinct instance of a purchase made by a customer, providing valuable insights into the volume of sales and customer engagement with Balanced Tree Clothing Company.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-average-unique-products-purchased-in-each-transaction" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-average-unique-products-purchased-in-each-transaction">2. What is the average unique products purchased in each transaction?</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(unique_products_purchased),<span class="dv">0</span>) <span class="kw">AS</span> avg_unique_products_purchased</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> txn_id,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> prod_id) <span class="kw">AS</span> unique_products_purchased</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> sales</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> txn_id</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> unique_products_count;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>avg_unique_products_purchased</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-unique-products-purchased" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-unique-products-purchased">Analysis of Average Unique Products Purchased</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The average number of unique products purchased in each transaction is 6. This metric indicates the diversity of products that customers typically buy in a single transaction, reflecting their preferences and shopping behavior.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-are-the-25th-50th-and-75th-percentile-values-for-the-revenue-per-transaction" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-25th-50th-and-75th-percentile-values-for-the-revenue-per-transaction">3. What are the 25th, 50th and 75th percentile values for the revenue per transaction?</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> revenue_per_transaction <span class="kw">AS</span> (</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        S.txn_id,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.qty <span class="op">*</span> S.price) <span class="kw">AS</span> total_revenue</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> S.txn_id</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> S.txn_id</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> percentile_group <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> total_revenue <span class="cf">END</span>) <span class="kw">AS</span> percentile_25,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> percentile_group <span class="op">=</span> <span class="dv">2</span> <span class="cf">THEN</span> total_revenue <span class="cf">END</span>) <span class="kw">AS</span> percentile_50,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> percentile_group <span class="op">=</span> <span class="dv">3</span> <span class="cf">THEN</span> total_revenue <span class="cf">END</span>) <span class="kw">AS</span> percentile_75</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        txn_id,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        total_revenue,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">NTILE</span>(<span class="dv">4</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> total_revenue) <span class="kw">as</span> percentile_group</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> revenue_per_transaction</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">AS</span> percentile_groups;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>percentile_25</th>
<th>percentile_50</th>
<th>percentile_75</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>375</td>
<td>509</td>
<td>647</td>
</tr>
</tbody>
</table>
<section id="analysis-of-revenue-percentile-values" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-revenue-percentile-values">Analysis of Revenue Percentile Values</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>These percentile values represent the revenue per transaction at different points in the distribution. For instance, the 25th percentile indicates that 25% of transactions have a revenue of $375 or lower, while the 75th percentile signifies that 75% of transactions have a revenue of $647 or lower. Understanding these values helps in assessing the distribution of revenue and identifying potential areas for improvement or optimization in sales strategies.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-average-discount-value-per-transaction" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-average-discount-value-per-transaction">4. What is the average discount value per transaction?</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(discount_value),<span class="dv">1</span>) <span class="kw">AS</span> avg_discount_value</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        txn_id,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fu">SUM</span>((price <span class="op">*</span> qty <span class="op">*</span> discount)<span class="op">/</span><span class="dv">100</span>),<span class="dv">0</span>) <span class="kw">AS</span> discount_value</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> sales</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> txn_id</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">AS</span> discount_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>avg_discount_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>62.5</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-discount-value-per-transaction" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-discount-value-per-transaction">Analysis of Average Discount Value per Transaction</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The Average Discount Value of $62.5, indicates the average discount applied per transaction across all purchases.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-percentage-split-of-all-transactions-for-members-vs-non-members" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-percentage-split-of-all-transactions-for-members-vs-non-members">5. What is the percentage split of all transactions for members vs non-members?</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> (<span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="kw">member</span> <span class="op">=</span> <span class="st">'t'</span> <span class="cf">THEN</span> txn_id <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span>(<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> txn_id)  <span class="kw">FROM</span> sales),<span class="dv">2</span>) <span class="kw">As</span> member_transaction_pct,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> (<span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="kw">member</span> <span class="op">=</span> <span class="st">'f'</span> <span class="cf">THEN</span> txn_id <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span>(<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> txn_id)  <span class="kw">FROM</span> sales),<span class="dv">2</span>) <span class="kw">As</span> non_member_transaction_pct</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>member_transaction_pct</th>
<th>non_member_transaction_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>60.24</td>
<td>39.84</td>
</tr>
</tbody>
</table>
<section id="analysis-of-percentage-split-of-transactions-members-vs-non-members" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-percentage-split-of-transactions-members-vs-non-members">Analysis of Percentage Split of Transactions: Members vs Non-members</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>The data reveals that a significant portion of transactions, approximately 60.24%, is attributed to members, while non-members contribute to about 39.84% of the total transactions. Understanding this split helps in assessing the contribution of membership programs to overall sales and in formulating strategies to attract and retain both member and non-member customers. It highlights the importance of analyzing the behavior and preferences of each segment to tailor marketing and loyalty initiatives effectively.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-average-revenue-for-member-transactions-and-non-member-transactions" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-average-revenue-for-member-transactions-and-non-member-transactions">6. What is the average revenue for member transactions and non-member transactions?</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> member_transactions_cte <span class="kw">AS</span> (</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">member</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        txn_id,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(qty<span class="op">*</span>price) <span class="kw">AS</span> avg_revenue</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> sales <span class="kw">GROUP</span> <span class="kw">BY</span> <span class="kw">member</span>,txn_id</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">member</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fu">AVG</span>(avg_revenue),<span class="dv">2</span>) <span class="kw">AS</span> avg_member_transactions</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> member_transactions_cte</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> <span class="kw">member</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>member</th>
<th>avg_member_transactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>t</td>
<td>516.27</td>
</tr>
<tr class="even">
<td>f</td>
<td>515.04</td>
</tr>
</tbody>
</table>
<section id="analysis-of-average-revenue-for-transactions-members-vs-non-members" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-average-revenue-for-transactions-members-vs-non-members">Analysis of Average Revenue for Transactions: Members vs Non-members</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>On average, member transactions generate slightly higher revenue compared to non-member transactions. This insight underscores the potential value of membership programs in driving higher spending per transaction. It suggests that members may be more inclined to make larger purchases or buy higher-priced items, indicating their engagement and loyalty to the brand. Understanding these differences in average revenue can inform targeted marketing strategies and personalized offerings to enhance customer satisfaction and retention.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-are-the-top-3-products-by-total-revenue-before-discount" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-top-3-products-by-total-revenue-before-discount">1. What are the top 3 products by total revenue before discount?</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PD.product_name,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(S.price <span class="op">*</span> S.qty) <span class="kw">AS</span> total_revenue_before_discount</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.product_name</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_revenue_before_discount <span class="kw">DESC</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">3</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>product_name</th>
<th>total_revenue_before_discount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blue Polo Shirt - Mens</td>
<td>217683</td>
</tr>
<tr class="even">
<td>Grey Fashion Jacket - Womens</td>
<td>209304</td>
</tr>
<tr class="odd">
<td>White Tee Shirt - Mens</td>
<td>152000</td>
</tr>
</tbody>
</table>
<section id="analysis-of-top-3-products-by-total-revenue-before-discount" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-top-3-products-by-total-revenue-before-discount">Analysis of Top 3 Products by Total Revenue Before Discount</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>Blue Polo Shirt - Mens: $217,683</li>
<li>Grey Fashion Jacket - Womens: $209,304</li>
<li>White Tee Shirt - Mens: $152,000</li>
</ul></li>
<li><p><strong>Observation</strong>:</p>
<ul>
<li>These top-selling products significantly contribute to the total revenue generated by the company before applying any discounts. Understanding the popularity and revenue performance of these products can help the company focus on effective marketing strategies, optimize inventory management, and identify opportunities for product bundling or upselling to further maximize revenue. Additionally, analyzing customer preferences and purchasing behavior related to these products can provide valuable insights for product development and assortment planning.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-total-quantity-revenue-and-discount-for-each-segment" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-quantity-revenue-and-discount-for-each-segment">2. What is the total quantity, revenue and discount for each segment?</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PD.segment_name,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>(S.qty),<span class="dv">2</span>) <span class="kw">AS</span> total_quantity,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>(S.qty <span class="op">*</span> S.price),<span class="dv">2</span>) <span class="kw">AS</span> total_revenue_before_discount,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>((S.qty <span class="op">*</span> S.price <span class="op">*</span> S.discount)<span class="op">/</span><span class="dv">100</span>), <span class="dv">2</span>) <span class="kw">AS</span> discount</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.segment_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 33%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>segment_name</th>
<th>total_quantity</th>
<th>total_revenue_before_discount</th>
<th>total_revenue_after_discount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Jeans</td>
<td>11349</td>
<td>208350</td>
<td>25343.97</td>
</tr>
<tr class="even">
<td>Shirt</td>
<td>11265</td>
<td>406143</td>
<td>49594.27</td>
</tr>
<tr class="odd">
<td>Socks</td>
<td>11217</td>
<td>307977</td>
<td>37013.44</td>
</tr>
<tr class="even">
<td>Jacket</td>
<td>11385</td>
<td>366983</td>
<td>44277.46</td>
</tr>
</tbody>
</table>
<section id="analysis-of-total-quantity-revenue-and-discount-by-segment" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-total-quantity-revenue-and-discount-by-segment">Analysis of Total Quantity, Revenue, and Discount by Segment</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>Jeans Segment:
<ul>
<li>Total Quantity: 11,349</li>
<li>Total Revenue Before Discount: $208,350</li>
<li>Total Discount: $25,343.97</li>
</ul></li>
<li>Shirt Segment:
<ul>
<li>Total Quantity: 11,265</li>
<li>Total Revenue Before Discount: $406,143</li>
<li>Total Discount: $49,594.27</li>
</ul></li>
<li>Socks Segment:
<ul>
<li>Total Quantity: 11,217</li>
<li>Total Revenue Before Discount: $307,977</li>
<li>Total Discount: $37,013.44</li>
</ul></li>
<li>Jacket Segment:
<ul>
<li>Total Quantity: 11,385</li>
<li>Total Revenue Before Discount: $366,983</li>
<li>Total Discount: $44,277.46</li>
</ul></li>
</ul></li>
<li><p><strong>Observation</strong>:</p>
<ul>
<li>These insights provide a breakdown of the total quantity sold, revenue generated before discounts, and total discount offered for each segment of products. Understanding the performance of different segments can help in strategic decision-making, such as allocating resources effectively, optimizing pricing strategies, and identifying areas for improvement or growth within each segment.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-top-selling-product-for-each-segment" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-top-selling-product-for-each-segment">3. What is the top selling product for each segment?</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> segment_product_qty_sales_cte <span class="kw">AS</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        PD.segment_name, PD.product_name,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.qty) <span class="kw">AS</span> total_qty_sold</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.segment_name, PD.product_name</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    top_selling_products_cte <span class="kw">AS</span> (</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        segment_product_qty_sales_cte.segment_name,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        segment_product_qty_sales_cte.product_name,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        segment_product_qty_sales_cte.total_qty_sold,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> segment_product_qty_sales_cte.segment_name</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ORDER</span> <span class="kw">BY</span> segment_product_qty_sales_cte.total_qty_sold <span class="kw">DESC</span>) <span class="kw">AS</span> row_num</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> segment_product_qty_sales_cte</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        top_selling_products_cte.segment_name,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        top_selling_products_cte.product_name,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        top_selling_products_cte.total_qty_sold</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> top_selling_products_cte</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> row_num <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>segment_name</th>
<th>product_name</th>
<th>total_qty_sold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Jacket</td>
<td>Grey Fashion Jacket - Womens</td>
<td>3876</td>
</tr>
<tr class="even">
<td>Jeans</td>
<td>Navy Oversized Jeans - Womens</td>
<td>3856</td>
</tr>
<tr class="odd">
<td>Shirt</td>
<td>Blue Polo Shirt - Mens</td>
<td>3819</td>
</tr>
<tr class="even">
<td>Socks</td>
<td>Navy Solid Socks - Mens</td>
<td>3792</td>
</tr>
</tbody>
</table>
<section id="analysis-of-top-selling-products-by-segment" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-top-selling-products-by-segment">Analysis of Top Selling Products by Segment</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li>Jacket Segment:
<ul>
<li>Product: Grey Fashion Jacket - Womens</li>
<li>Total Quantity Sold: 3,876</li>
</ul></li>
<li>Jeans Segment:
<ul>
<li>Product: Navy Oversized Jeans - Womens</li>
<li>Total Quantity Sold: 3,856</li>
</ul></li>
<li>Shirt Segment:
<ul>
<li>Product: Blue Polo Shirt - Mens</li>
<li>Total Quantity Sold: 3,819</li>
</ul></li>
<li>Socks Segment:
<ul>
<li>Navy Solid Socks - Mens</li>
<li>Total Quantity Sold: 3,792</li>
</ul></li>
</ul></li>
<li><p><strong>Observation</strong>:</p>
<ul>
<li>Identifying the top-selling products in each segment helps in understanding consumer preferences and market demand within different product categories. This information can be valuable for inventory management, marketing strategies, and product development initiatives to further enhance sales and customer satisfaction.</li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-total-quantity-revenue-and-discount-for-each-category" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-quantity-revenue-and-discount-for-each-category">4. What is the total quantity, revenue and discount for each category?</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> PD.category_name,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>(S.qty),<span class="dv">2</span>) <span class="kw">AS</span> total_quantity,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>(S.qty <span class="op">*</span> S.price),<span class="dv">2</span>) <span class="kw">AS</span> total_revenue_before_discount,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">SUM</span>((S.qty <span class="op">*</span> S.price <span class="op">*</span> S.discount)<span class="op">/</span><span class="dv">100</span>), <span class="dv">2</span>) <span class="kw">AS</span> discount</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> PD.category_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 41%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>category_name</th>
<th>total_quantity</th>
<th>total_revenue_before_discount</th>
<th>discount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Womens</td>
<td>22734</td>
<td>575333</td>
<td>69621.43</td>
</tr>
<tr class="even">
<td>Mens</td>
<td>22482</td>
<td>714120</td>
<td>86607.71</td>
</tr>
</tbody>
</table>
<section id="analysis-of" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-top-selling-product-for-each-category" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-top-selling-product-for-each-category">5. What is the top selling product for each category?</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> category_product_qty_sales_cte <span class="kw">AS</span> (</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        PD.category_name,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        PD.product_name,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.qty) <span class="kw">AS</span> total_qty_sold</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.category_name, PD.product_name</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    top_selling_products_cte <span class="kw">AS</span> (</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        category_product_qty_sales_cte.category_name,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        category_product_qty_sales_cte.product_name,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        category_product_qty_sales_cte.total_qty_sold,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> category_product_qty_sales_cte.category_name</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ORDER</span> <span class="kw">BY</span> category_product_qty_sales_cte.total_qty_sold <span class="kw">DESC</span>) <span class="kw">AS</span> row_num</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> category_product_qty_sales_cte</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        top_selling_products_cte.category_name,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        top_selling_products_cte.product_name,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    top_selling_products_cte.total_qty_sold</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> top_selling_products_cte</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> row_num <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>category_name</th>
<th>product_name</th>
<th>total_qty_sold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mens</td>
<td>Blue Polo Shirt - Mens</td>
<td>3819</td>
</tr>
<tr class="even">
<td>Womens</td>
<td>Grey Fashion Jacket - Womens</td>
<td>3876</td>
</tr>
</tbody>
</table>
<section id="analysis-of-1" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-1">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-percentage-split-of-revenue-by-product-for-each-segment" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-percentage-split-of-revenue-by-product-for-each-segment">6. What is the percentage split of revenue by product for each segment?</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> segment_product_revenue_cte <span class="kw">AS</span> (</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        PD.segment_name,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        PD.product_name,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.price <span class="op">*</span> S.qty) <span class="kw">AS</span> segment_product_revenue</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.segment_name, PD.product_name</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        segment_name,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        product_name,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> segment_product_revenue <span class="op">/</span> (</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(segment_product_revenue) <span class="kw">OVER</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>            (<span class="kw">PARTITION</span> <span class="kw">BY</span> segment_name)), <span class="dv">2</span>) <span class="kw">AS</span> revenue_pct</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> segment_product_revenue_cte</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> segment_name, product_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>segment_name</th>
<th>product_name</th>
<th>revenue_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Jacket</td>
<td>Grey Fashion Jacket - Womens</td>
<td>57.03</td>
</tr>
<tr class="even">
<td>Jacket</td>
<td>Indigo Rain Jacket - Womens</td>
<td>19.45</td>
</tr>
<tr class="odd">
<td>Jacket</td>
<td>Khaki Suit Jacket - Womens</td>
<td>23.51</td>
</tr>
<tr class="even">
<td>Jeans</td>
<td>Black Straight Jeans - Womens</td>
<td>58.15</td>
</tr>
<tr class="odd">
<td>Jeans</td>
<td>Cream Relaxed Jeans - Womens</td>
<td>17.79</td>
</tr>
<tr class="even">
<td>Jeans</td>
<td>Navy Oversized Jeans - Womens</td>
<td>24.06</td>
</tr>
<tr class="odd">
<td>Shirt</td>
<td>Blue Polo Shirt - Mens</td>
<td>53.60</td>
</tr>
<tr class="even">
<td>Shirt</td>
<td>Teal Button Up Shirt - Mens</td>
<td>8.98</td>
</tr>
<tr class="odd">
<td>Shirt</td>
<td>White Tee Shirt - Mens</td>
<td>37.43</td>
</tr>
<tr class="even">
<td>Socks</td>
<td>Navy Solid Socks - Mens</td>
<td>44.33</td>
</tr>
<tr class="odd">
<td>Socks</td>
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>35.50</td>
</tr>
<tr class="even">
<td>Socks</td>
<td>White Striped Socks - Mens</td>
<td>20.18</td>
</tr>
</tbody>
</table>
<section id="analysis-of-2" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-2">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-percentage-split-of-revenue-by-segment-for-each-category" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-percentage-split-of-revenue-by-segment-for-each-category">7. What is the percentage split of revenue by segment for each category?</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> category_segment_revenue_cte <span class="kw">AS</span> (</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        PD.category_name,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        PD.segment_name,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.price <span class="op">*</span> S.qty) <span class="kw">AS</span> category_segment_revenue</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.category_name, PD.segment_name</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        category_name,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        segment_name,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> category_segment_revenue <span class="op">/</span> (</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(category_segment_revenue) <span class="kw">OVER</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>            (<span class="kw">PARTITION</span> <span class="kw">BY</span> category_name)), <span class="dv">2</span>) <span class="kw">AS</span> revenue_pct</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> category_segment_revenue_cte</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> category_name, segment_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>category_name</th>
<th>segment_name</th>
<th>revenue_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mens</td>
<td>Shirt</td>
<td>56.87</td>
</tr>
<tr class="even">
<td>Mens</td>
<td>Socks</td>
<td>43.13</td>
</tr>
<tr class="odd">
<td>Womens</td>
<td>Jacket</td>
<td>63.79</td>
</tr>
<tr class="even">
<td>Womens</td>
<td>Jeans</td>
<td>36.21</td>
</tr>
</tbody>
</table>
<section id="analysis-of-3" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-3">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-percentage-split-of-total-revenue-by-category" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-percentage-split-of-total-revenue-by-category">8. What is the percentage split of total revenue by category?</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> category_revenue_cte <span class="kw">AS</span> (</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        PD.category_name,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">SUM</span>(S.price <span class="op">*</span> S.qty) <span class="kw">AS</span> category_revenue</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.category_name</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> category_name,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> category_revenue <span class="op">/</span> (</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(category_revenue) <span class="kw">OVER</span>()), <span class="dv">2</span>) <span class="kw">AS</span> revenue_pct</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> category_revenue_cte</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> category_name</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> category_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>category_name</th>
<th>revenue_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mens</td>
<td>55.38</td>
</tr>
<tr class="even">
<td>Womens</td>
<td>44.62</td>
</tr>
</tbody>
</table>
<section id="analysis-of-4" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-4">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-total-transaction-penetration-for-each-product-hint-penetration-number-of-transactions-where-at-least-1-quantity-of-a-product-was-purchased-divided-by-total-number-of-transactions" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-total-transaction-penetration-for-each-product-hint-penetration-number-of-transactions-where-at-least-1-quantity-of-a-product-was-purchased-divided-by-total-number-of-transactions">9. What is the total transaction “penetration” for each product? (hint: penetration = number of transactions where at least 1 quantity of a product was purchased divided by total number of transactions)</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> product_transactions <span class="kw">AS</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        PD.product_name,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> S.txn_id) <span class="kw">AS</span> product_transactions,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> txn_id)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> sales) <span class="kw">AS</span> total_number_of_transactions</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_details <span class="kw">AS</span> PD</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> sales <span class="kw">AS</span> S</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> PD.product_id <span class="op">=</span> S.prod_id</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> PD.product_name</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        product_name,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ROUND</span>(<span class="fl">100.0</span> <span class="op">*</span> (product_transactions<span class="op">/</span>total_number_of_transactions),<span class="dv">2</span>) <span class="kw">AS</span> product_penetration</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> product_transactions</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> product_penetration <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<thead>
<tr class="header">
<th>product_name</th>
<th>product_penetration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Navy Solid Socks - Mens</td>
<td>51.24</td>
</tr>
<tr class="even">
<td>Grey Fashion Jacket - Womens</td>
<td>51.00</td>
</tr>
<tr class="odd">
<td>Navy Oversized Jeans - Womens</td>
<td>50.96</td>
</tr>
<tr class="even">
<td>Blue Polo Shirt - Mens</td>
<td>50.72</td>
</tr>
<tr class="odd">
<td>White Tee Shirt - Mens</td>
<td>50.72</td>
</tr>
<tr class="even">
<td>Pink Fluro Polkadot Socks - Mens</td>
<td>50.32</td>
</tr>
<tr class="odd">
<td>Indigo Rain Jacket - Womens</td>
<td>50.00</td>
</tr>
<tr class="even">
<td>Khaki Suit Jacket - Womens</td>
<td>49.88</td>
</tr>
<tr class="odd">
<td>Black Straight Jeans - Womens</td>
<td>49.84</td>
</tr>
<tr class="even">
<td>Cream Relaxed Jeans - Womens</td>
<td>49.72</td>
</tr>
<tr class="odd">
<td>White Striped Socks - Mens</td>
<td>49.72</td>
</tr>
<tr class="even">
<td>Teal Button Up Shirt - Mens</td>
<td>49.68</td>
</tr>
</tbody>
</table>
<section id="analysis-of-5" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-5">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>
</section>
</section>
<section id="what-is-the-most-common-combination-of-at-least-1-quantity-of-any-3-products-in-a-1-single-transaction" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-most-common-combination-of-at-least-1-quantity-of-any-3-products-in-a-1-single-transaction">10. What is the most common combination of at least 1 quantity of any 3 products in a 1 single transaction?</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> products_per_transaction <span class="kw">AS</span> (</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> s.txn_id, pd.product_id, pd.product_name, s.qty,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COUNT</span>(pd.product_id) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> txn_id) <span class="kw">AS</span> cnt</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> sales s</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> product_details pd <span class="kw">ON</span> s.prod_id <span class="op">=</span> pd.product_id</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>), combinations <span class="kw">AS</span> (</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        GROUP_CONCAT(product_id <span class="kw">ORDER</span> <span class="kw">BY</span> product_id) <span class="kw">AS</span> product_ids,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        GROUP_CONCAT(product_name <span class="kw">ORDER</span> <span class="kw">BY</span> product_id) <span class="kw">AS</span> product_names</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> products_per_transaction</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> cnt <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> txn_id</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>), combination_count <span class="kw">AS</span> (</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> product_ids, product_names, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> common_combinations</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> combinations</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> product_ids, product_names</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>) <span class="kw">SELECT</span> product_ids, product_names</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> combination_count</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> common_combinations <span class="op">=</span> (<span class="kw">SELECT</span> <span class="fu">MAX</span>(common_combinations) <span class="kw">FROM</span> combination_count);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<table class="table">
<colgroup>
<col style="width: 34%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Product IDs</th>
<th>Product Names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5d267b,c4a632,e31d39</td>
<td>White Tee Shirt - Mens, Navy Oversized Jeans - Womens, Cream Relaxed Jeans - Womens</td>
</tr>
<tr class="even">
<td>b9a74d,c4a632,d5e9a6</td>
<td>White Striped Socks - Mens, Navy Oversized Jeans - Womens, Khaki Suit Jacket - Womens</td>
</tr>
<tr class="odd">
<td>2a2353,2feb6b,c4a632</td>
<td>Blue Polo Shirt - Mens, Pink Fluro Polkadot Socks - Mens, Navy Oversized Jeans - Womens</td>
</tr>
<tr class="even">
<td>5d267b,c4a632,e83aa3</td>
<td>White Tee Shirt - Mens, Navy Oversized Jeans - Womens, Black Straight Jeans - Womens</td>
</tr>
<tr class="odd">
<td>c4a632,c8d436,e83aa3</td>
<td>Navy Oversized Jeans - Womens, Teal Button Up Shirt - Mens, Black Straight Jeans - Womens</td>
</tr>
</tbody>
</table>
<section id="analysis-of-6" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-6">Analysis of</h4>
<ol type="1">
<li><p><strong>Insights</strong>:</p>
<ul>
<li></li>
</ul></li>
</ol>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>